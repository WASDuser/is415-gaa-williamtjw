<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="William">
<meta name="dcterms.date" content="2024-09-23">

<title>Take-Home Exercise 2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level – IS415</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">IS415</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../../resources/Hands-on_Ex/ex1/Hands-On_Ex_1.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/Hands-on_Ex/ex2/Hands-On_Ex_2.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/Hands-on_Ex/ex3/Hands-On_Ex_3.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/Hands-on_Ex/ex4/Hands-On_Ex_4.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/Hands-on_Ex/ex5/Hands-On_Ex_5.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/Hands-on_Ex/ex6/Hands-On_Ex_6.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise-(ice" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise (ICE)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise-(ice">    
        <li>
    <a class="dropdown-item" href="../../../resources/ICEs/ex1/ice1.html">
 <span class="dropdown-text">ICE 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/ICEs/ex2/ice2.html">
 <span class="dropdown-text">ICE 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/ICEs/ex3/ice3.html">
 <span class="dropdown-text">ICE 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/ICEs/ex4/ice4.html">
 <span class="dropdown-text">ICE 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/ICEs/ex5/ice5.html">
 <span class="dropdown-text">ICE 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/ICEs/ex6/ice6.html">
 <span class="dropdown-text">ICE 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise-(the" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise (THE)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise-(the">    
        <li>
    <a class="dropdown-item" href="../../../resources/Take-home_Ex/ex1/Take-home_Ex_1.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../resources/Take-home_Ex/ex2/Take-home_Ex_2.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#terms" id="toc-terms" class="nav-link" data-scroll-target="#terms">Terms</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#r-packages-used" id="toc-r-packages-used" class="nav-link" data-scroll-target="#r-packages-used">R Packages used</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#aggregating-by-province" id="toc-aggregating-by-province" class="nav-link" data-scroll-target="#aggregating-by-province">Aggregating by Province</a>
  <ul class="collapse">
  <li><a href="#relational-join" id="toc-relational-join" class="nav-link" data-scroll-target="#relational-join">Relational Join</a></li>
  <li><a href="#landmine" id="toc-landmine" class="nav-link" data-scroll-target="#landmine">Landmine</a></li>
  <li><a href="#fixing-mispelled-province-names" id="toc-fixing-mispelled-province-names" class="nav-link" data-scroll-target="#fixing-mispelled-province-names">Fixing Mispelled Province Names</a></li>
  <li><a href="#again-relational-join" id="toc-again-relational-join" class="nav-link" data-scroll-target="#again-relational-join">[Again] Relational Join</a></li>
  <li><a href="#distribution-of-no_cases" id="toc-distribution-of-no_cases" class="nav-link" data-scroll-target="#distribution-of-no_cases">Distribution of <code>no_cases</code></a></li>
  <li><a href="#visualise-actual-cases" id="toc-visualise-actual-cases" class="nav-link" data-scroll-target="#visualise-actual-cases">Visualise actual cases</a></li>
  </ul></li>
  <li><a href="#aggregating-by-time-province-same-as-on-profs-site" id="toc-aggregating-by-time-province-same-as-on-profs-site" class="nav-link" data-scroll-target="#aggregating-by-time-province-same-as-on-profs-site">Aggregating by Time &amp; Province (Same as on Prof’s site)</a>
  <ul class="collapse">
  <li><a href="#check" id="toc-check" class="nav-link" data-scroll-target="#check">Check</a></li>
  <li><a href="#visualise-using-tmap" id="toc-visualise-using-tmap" class="nav-link" data-scroll-target="#visualise-using-tmap">Visualise using <code>tmap</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualising-drug-abuse-indicators" id="toc-visualising-drug-abuse-indicators" class="nav-link" data-scroll-target="#visualising-drug-abuse-indicators">Visualising Drug Abuse Indicators</a>
  <ul class="collapse">
  <li><a href="#prepare-layers" id="toc-prepare-layers" class="nav-link" data-scroll-target="#prepare-layers">Prepare layers</a></li>
  <li><a href="#rds-checkpoint" id="toc-rds-checkpoint" class="nav-link" data-scroll-target="#rds-checkpoint">RDS Checkpoint</a></li>
  <li><a href="#visualise" id="toc-visualise" class="nav-link" data-scroll-target="#visualise">Visualise</a></li>
  </ul></li>
  <li><a href="#global-spatial-autocorrelation-analysis" id="toc-global-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#global-spatial-autocorrelation-analysis">Global Spatial Autocorrelation Analysis</a>
  <ul class="collapse">
  <li><a href="#global-morans-i-with-permutation-testing" id="toc-global-morans-i-with-permutation-testing" class="nav-link" data-scroll-target="#global-morans-i-with-permutation-testing">Global Moran’s I with permutation testing</a></li>
  <li><a href="#gearys-c" id="toc-gearys-c" class="nav-link" data-scroll-target="#gearys-c">Geary’s C</a></li>
  <li><a href="#spatial-correlogram" id="toc-spatial-correlogram" class="nav-link" data-scroll-target="#spatial-correlogram">Spatial Correlogram</a>
  <ul class="collapse">
  <li><a href="#morans-i" id="toc-morans-i" class="nav-link" data-scroll-target="#morans-i">Moran’s I</a></li>
  <li><a href="#gearys-c-1" id="toc-gearys-c-1" class="nav-link" data-scroll-target="#gearys-c-1">Geary’s C</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#local-indicators-of-spatial-association-lisa" id="toc-local-indicators-of-spatial-association-lisa" class="nav-link" data-scroll-target="#local-indicators-of-spatial-association-lisa">Local Indicators of Spatial Association (LISA)</a></li>
  <li><a href="#hot-spot-and-cold-spot-area-analysis-getis-and-ords-g-statistics" id="toc-hot-spot-and-cold-spot-area-analysis-getis-and-ords-g-statistics" class="nav-link" data-scroll-target="#hot-spot-and-cold-spot-area-analysis-getis-and-ords-g-statistics">Hot Spot and Cold Spot Area Analysis (Getis and Ord’s G-Statistics)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-Home Exercise 2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>William </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 13, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="background" class="level1">
<h1>Background</h1>
<p>Nothing for now.</p>
</section>
<section id="terms" class="level1">
<h1>Terms</h1>
<ul>
<li><p>Thailand administrative level 0 (country): <strong>admin0</strong>,</p></li>
<li><p>1 (province): <strong>admin1</strong></p></li>
<li><p>2 (district): <strong>admin2</strong></p></li>
<li><p>3 (sub-district, tambon): <strong>admin3</strong></p></li>
</ul>
<p>For the purposes of this exercise I will be dealing with <strong>admin1</strong> only (province-level).</p>
</section>
<section id="objectives" class="level1">
<h1>Objectives</h1>
</section>
<section id="r-packages-used" class="level1">
<h1>R Packages used</h1>
<ul>
<li><p>sf</p></li>
<li><p>tidyverse</p></li>
<li><p><a href="https://readxl.tidyverse.org/"><strong>readxl</strong></a>: since both datasets are in xls/xlsx format</p></li>
<li><p>skimr</p></li>
<li><p>sfdep</p></li>
<li><p>tmap</p></li>
<li><p>fitdist: finding out distribution type to match to match tmap style</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf,tidyverse,skimr,readxl,spdep, sfdep,tmap,fitdistrplus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">[.csv] Thailand Drug Offenses 2017-2022</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">[.shp] Thailand - Subnational Admin. Boundaries</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-drug-offenses-2017-2022"><strong>Source</strong></a></p>
<section id="metadata" class="level3">
<h3 class="anchored" data-anchor-id="metadata">Metadata</h3>
<ul>
<li><p>fiscal_year: recorded year</p></li>
<li><p>types_of_drug_offenses: category of offense</p></li>
<li><p>no_cases: total records for combination of year, drug offense type and province</p></li>
<li><p>province_th: province name in thai (<strong>drop</strong>)</p></li>
<li><p>province_en</p></li>
</ul>
</section>
<section id="import" class="level3">
<h3 class="anchored" data-anchor-id="import">Import</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>thai_drug_offences_sf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/aspatial/thai_drug_offenses_2017_2022.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(thai_drug_offences_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>summ_table <span class="ot">&lt;-</span> <span class="fu">skim</span>(thai_drug_offences_sf) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>summ_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  skim_type          skim_variable n_missing complete_rate character.min
1 character types_of_drug_offenses         0             1            12
2 character            province_th         0             1             3
3 character            province_en         0             1             3
4   numeric            fiscal_year         0             1            NA
5   numeric               no_cases         0             1            NA
  character.max character.empty character.n_unique character.whitespace
1            54               0                 16                    0
2            15               0                 77                    0
3            24               0                 77                    0
4            NA              NA                 NA                   NA
5            NA              NA                 NA                   NA
  numeric.mean  numeric.sd numeric.p0 numeric.p25 numeric.p50 numeric.p75
1           NA          NA         NA          NA          NA          NA
2           NA          NA         NA          NA          NA          NA
3           NA          NA         NA          NA          NA          NA
4    2019.5000    1.707941       2017        2018      2019.5        2021
5     535.3486 1130.876262          0           1        70.0         623
  numeric.p100 numeric.hist
1           NA         &lt;NA&gt;
2           NA         &lt;NA&gt;
3           NA         &lt;NA&gt;
4         2022        ▇▃▃▃▃
5        17131        ▇▁▁▁▁</code></pre>
</div>
</div>
<blockquote class="blockquote">
<ul>
<li><p>No missing data</p></li>
<li><p>Date range is indeed 2017 to 2022</p></li>
<li><p>16 types of drug offenses (check unique values)</p></li>
<li><p>summary statistics of overall <strong><code>no_cases</code></strong> seem to indicate <strong>right-skew</strong></p></li>
</ul>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>thai_no_case <span class="ot">&lt;-</span> summ_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(skim_variable <span class="sc">==</span> <span class="st">'no_cases'</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">16</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>thai_no_case</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  numeric.mean numeric.sd numeric.p0 numeric.p25 numeric.p50 numeric.p75
1     535.3486   1130.876          0           1          70         623
  numeric.p100
1        17131</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Might need to view by offense type to see offense-specific distributions</p>
</blockquote>
<p><strong>Identify the unique values for each categorical column</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(thai_drug_offences_sf<span class="sc">$</span>fiscal_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>offense_type <span class="ot">&lt;-</span> <span class="fu">unique</span>(thai_drug_offences_sf<span class="sc">$</span>types_of_drug_offenses)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>offense_type</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-relevant-columns" class="level3">
<h3 class="anchored" data-anchor-id="extracting-relevant-columns">Extracting relevant columns</h3>
<p><strong>Remove thai labels</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>thai_drug_offences_sf <span class="ot">&lt;-</span> thai_drug_offences_sf <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><a href="https://data.humdata.org/dataset/d24bdc45-eb4c-4e3d-8b16-44db02667c27/resource/d0c722ff-6939-4423-ac0d-6501830b1759/download/tha_adm_rtsd_itos_20210121_shp.zip"><strong>Source</strong></a></p>
<section id="import-1" class="level3">
<h3 class="anchored" data-anchor-id="import-1">Import</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>thai_admin1_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dsn =</span> <span class="st">'data/geospatial/tha_adm_rtsd_itos_20210121_shp/'</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer =</span><span class="st">'tha_admbnda_adm1_rtsd_20220121'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm1_rtsd_20220121' from data source 
  `/Users/williamtjw/is415-gaa-williamtjw/resources/Take-home_Ex/ex2/data/geospatial/tha_adm_rtsd_itos_20210121_shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(thai_admin1_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-relevant-data" class="level3">
<h3 class="anchored" data-anchor-id="extracting-relevant-data">Extracting relevant data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>thai_admin1_sf <span class="ot">&lt;-</span> thai_admin1_sf <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ADM1_EN =</span> <span class="fu">toupper</span>(ADM1_EN),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ADM1_PCODE =</span> <span class="fu">substr</span>(ADM1_PCODE, <span class="dv">3</span>, <span class="fu">nchar</span>(ADM1_PCODE)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
</div>
</div>
<section id="aggregating-by-province" class="level2">
<h2 class="anchored" data-anchor-id="aggregating-by-province">Aggregating by Province</h2>
<section id="relational-join" class="level3">
<h3 class="anchored" data-anchor-id="relational-join">Relational Join</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>province_drug_offences <span class="ot">&lt;-</span> thai_drug_offences_sf <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_en) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_cases =</span> <span class="fu">sum</span>(no_cases), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(province_drug_offences)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>combined_prepped_drug_offences_ <span class="ot">&lt;-</span> <span class="fu">left_join</span>(province_drug_offences, thai_admin1_sf,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>)) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(combined_prepped_drug_offences_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(combined_prepped_drug_offences_)<span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">alpha =</span> .<span class="dv">5</span>,<span class="at">col =</span> combined_prepped_drug_offences_<span class="sc">$</span>total_cases)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(combined_prepped_drug_offences_<span class="sc">$</span>province_en)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="landmine" class="level3">
<h3 class="anchored" data-anchor-id="landmine">Landmine</h3>
<p>This is where I encountered the first landmine of sorts. The above code results in:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="st">`</span><span class="at">$&lt;-</span><span class="st">`</span><span class="sc">:</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> Assigned data <span class="st">`</span><span class="at">as.numeric(...)</span><span class="st">`</span> must be compatible with existing data.</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>✖ Existing data has <span class="dv">77</span> rows.</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>✖ Assigned data has <span class="dv">75</span> rows.</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ℹ Only vectors of size <span class="dv">1</span> are recycled.</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>Caused by error <span class="cf">in</span> <span class="st">`</span><span class="at">vectbl_recycle_rhs_rows()</span><span class="st">`</span><span class="sc">:</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> Can<span class="st">'t recycle input of size 75 to size 77.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>So I went to re-check the left-joined table <code>prepped_drug_offences</code> . I realised for the “buogkan” and “Loburi” rows, besides the ‘total_cases’ field, the rest of the fields were empty.</p>
<p>Seeing how suspiciously “buogkan” looks like a typo, I went to Google both “buogkan” and “Loburi” along with Thailand. Sure enough, the suggested words of “buogkan” and “Loburi” turned out to be <strong>“Bueng Kan” and “Lop buri”</strong> respectively.</p>
<p>Turned out the <strong>Thailand Drug Offenses</strong> <strong>had the 2 erroneous province names</strong>, while the shapefiles’ province labels checked out.</p>
<p>I will have to do manual replacements for all affected fields in <code>thai_drug_offences_sf</code></p>
</section>
<section id="fixing-mispelled-province-names" class="level3">
<h3 class="anchored" data-anchor-id="fixing-mispelled-province-names">Fixing Mispelled Province Names</h3>
<p><strong>Check before</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(thai_drug_offences_sf<span class="sc">$</span>province_en)[<span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Loburi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(thai_drug_offences_sf<span class="sc">$</span>province_en)[<span class="dv">30</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "buogkan"</code></pre>
</div>
</div>
<p><strong>Rename and Standardise Case</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>thai_drug_offences_sf<span class="sc">$</span>province_en[<span class="fu">which</span>(thai_drug_offences_sf<span class="sc">$</span>province_en <span class="sc">==</span> <span class="st">"Loburi"</span>)] <span class="ot">&lt;-</span> <span class="st">'Lop buri'</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>thai_drug_offences_sf<span class="sc">$</span>province_en[<span class="fu">which</span>(thai_drug_offences_sf<span class="sc">$</span>province_en <span class="sc">==</span> <span class="st">"buogkan"</span>)] <span class="ot">&lt;-</span> <span class="st">'Bueng Kan'</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>thai_drug_offences_sf <span class="ot">&lt;-</span> thai_drug_offences_sf <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">province_en =</span> <span class="fu">toupper</span>(province_en))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Check fix</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(thai_drug_offences_sf<span class="sc">$</span>province_en)[<span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LOP BURI"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(thai_drug_offences_sf<span class="sc">$</span>province_en)[<span class="dv">30</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BUENG KAN"</code></pre>
</div>
</div>
<p>That should resolve the landmine.</p>
<p><strong>Separating suspected cases using <code>grepl()</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># suspected</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>suspected_offenses_sf <span class="ot">&lt;-</span> thai_drug_offences_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"suspects"</span>, types_of_drug_offenses))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># actual</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>offenses_sf <span class="ot">&lt;-</span> thai_drug_offences_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"suspects"</span>, types_of_drug_offenses)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I split <code>thai_drug_offences_sf</code> into confirmed cases (<code>offenses_sf</code>) and suspected cases(<code>suspected_offenses_sf</code>), because including suspected cases may skew the overall analysis results, adding noise and uncertainty to confirmed drug abuse activity. Splitting allows for separate modelling of suspected cases, which can value-add to the detection of drug abuse in areas of concern.</p>
</section>
<section id="again-relational-join" class="level3">
<h3 class="anchored" data-anchor-id="again-relational-join">[Again] Relational Join</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># actual</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>combined_offenses_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    offenses_sf <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(province_en) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">total_cases =</span> <span class="fu">sum</span>(no_cases), <span class="at">.groups =</span> <span class="st">'drop'</span>)),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    thai_admin1_sf,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(combined_offenses_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># suspected</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>combined_suspected_offenses_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    suspected_offenses_sf <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">province_en =</span> <span class="fu">toupper</span>(province_en)) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(province_en) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">total_cases =</span> <span class="fu">sum</span>(no_cases), <span class="at">.groups =</span> <span class="st">'drop'</span>)),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    thai_admin1_sf <span class="sc">%&gt;%</span> </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">ADM1_EN =</span> <span class="fu">toupper</span>(ADM1_EN),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">ADM1_PCODE =</span> <span class="fu">substr</span>(ADM1_PCODE, <span class="dv">3</span>, <span class="fu">nchar</span>(ADM1_PCODE)))),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(combined_suspected_offenses_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="distribution-of-no_cases" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-no_cases">Distribution of <code>no_cases</code></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Big Picture</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Aggregated Cases by Province across 2017-2022</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><strong>Overall Visualisations</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>basemap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_offenses_sf) <span class="sc">+</span> <span class="fu">tm_polygons</span>() <span class="sc">+</span> <span class="fu">tm_text</span>(<span class="st">"ADM1_PCODE"</span>,<span class="at">size =</span> <span class="fl">0.4</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>offenses <span class="ot">&lt;-</span> <span class="fu">qtm</span>(combined_offenses_sf,<span class="st">"total_cases"</span>,<span class="at">title =</span> <span class="st">'confirmed offenses'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>suspects <span class="ot">&lt;-</span> <span class="fu">qtm</span>(combined_suspected_offenses_sf,<span class="st">"total_cases"</span>, <span class="at">title =</span> <span class="st">'suspected offenses'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(suspects, basemap, offenses, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Overall Distribution</strong></p>
<ul>
<li><strong>Actual</strong></li>
</ul>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(offenses_sf<span class="sc">$</span>no_cases)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitdist</span>(offenses_sf<span class="sc">$</span>no_cases, <span class="st">'norm'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<ul>
<li><strong>Suspected</strong></li>
</ul>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(suspected_offenses_sf<span class="sc">$</span>no_cases)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitdist</span>(suspected_offenses_sf<span class="sc">$</span>no_cases, <span class="st">'norm'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<ul>
<li><strong>Actual</strong></li>
</ul>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(combined_offenses_sf<span class="sc">$</span>total_cases, )</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitdist</span>(combined_offenses_sf<span class="sc">$</span>total_cases, <span class="st">'norm'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<ul>
<li><strong>Suspected</strong></li>
</ul>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(combined_suspected_offenses_sf<span class="sc">$</span>total_cases)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitdist</span>(combined_suspected_offenses_sf<span class="sc">$</span>total_cases, <span class="st">'norm'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<blockquote class="blockquote">
<p><strong>Conclusions: Right Skewed, heavy right tail, outliers present; Actual and Suspected cases follow the similar distribution</strong></p>
<p>Hence, to visualise the continuous variable <code>total_cases</code> , lets experiment with:</p>
<ul>
<li><p><code>quantile</code></p></li>
<li><p><code>log10</code></p></li>
<li><p><code>order</code></p></li>
<li><p><code>headtails</code></p></li>
<li><p><code>log10_pretty</code></p></li>
<li><p><code>cont</code></p></li>
</ul>
</blockquote>
</section>
</section>
<section id="visualise-actual-cases" class="level3">
<h3 class="anchored" data-anchor-id="visualise-actual-cases">Visualise actual cases</h3>
<blockquote class="blockquote">
<p><a href="https://r-tmap.github.io/tmap-book/visual-variables.html">Visual styling</a></p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">style = “quantile”</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">style = “log10”</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">style = “order”</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">style = ‘headtails’</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">style = ‘log10_pretty’</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">style = ‘cont’</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>offenses_qt <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_offenses_sf) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"quantile"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Offenses (2017-2022)"</span>,</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">0.666</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>suspected_qt <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_suspected_offenses_sf) <span class="sc">+</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"quantile"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Suspected Offenses (2017-2022)"</span>,</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">0.666</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(offenses_qt, suspected_qt, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>offenses_log <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_offenses_sf) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"log10"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Offenses (2017-2022)"</span>,</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>suspected_log <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_suspected_offenses_sf) <span class="sc">+</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"log10"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Suspected Offenses (2017-2022)"</span>,</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(offenses_log, suspected_log, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>offenses_odr <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_offenses_sf) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"order"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Offenses (2017-2022)"</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>suspected_odr <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_suspected_offenses_sf) <span class="sc">+</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"order"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Suspected Offenses (2017-2022)"</span>,</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(offenses_odr, suspected_odr, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>offenses_ht <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_offenses_sf) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"headtails"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Offenses (2017-2022)"</span>,</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>suspected_ht <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_suspected_offenses_sf) <span class="sc">+</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"headtails"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Suspected Offenses (2017-2022)"</span>,</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(offenses_ht, suspected_ht, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>offenses_lgprty <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_offenses_sf) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"log10_pretty"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Offenses (2017-2022)"</span>,</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>suspected_lgprty <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_suspected_offenses_sf) <span class="sc">+</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"log10_pretty"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Suspected Offenses (2017-2022)"</span>,</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(offenses_lgprty, suspected_lgprty, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>offenses_cont <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_offenses_sf) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"cont"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Offenses (2017-2022)"</span>,</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>suspected_cont <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(combined_suspected_offenses_sf) <span class="sc">+</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"cont"</span>,    <span class="co"># Use quantiles to emphasize hotspots</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.col =</span> <span class="st">"white"</span>,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.666</span>,             <span class="co"># Adjust line width of province borders</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ADM1_PCODE"</span>,    <span class="co"># Province NUMERIC code</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"total_cases"</span>,  <span class="co"># proportional symbols</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># auto.placement = TRUE,</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">shadow =</span> <span class="cn">TRUE</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">0.666</span>) <span class="sc">+</span>  <span class="co"># Border thickness</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="fl">1.666</span>) <span class="sc">+</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.156</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))  <span class="sc">+</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Thailand Drug Suspected Offenses (2017-2022)"</span>,</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">1.0</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>)) <span class="co"># Legend Position</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(offenses_cont, suspected_cont, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><code>'log10'</code> style had the best visualisation of the distribution drug offenses in terms of <strong>contrast</strong> between ‘hot’ and ‘cold’ spots and overall aesthetics.</p>
</blockquote>
</section>
</section>
<section id="aggregating-by-time-province-same-as-on-profs-site" class="level2">
<h2 class="anchored" data-anchor-id="aggregating-by-time-province-same-as-on-profs-site">Aggregating by Time &amp; Province (Same as on Prof’s site)</h2>
<section id="relational-join-1" class="level4">
<h4 class="anchored" data-anchor-id="relational-join-1">Relational Join</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>offences_sf_joined <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    (offenses_sf  <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fiscal_year)),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    thai_admin1_sf,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_as_sf</span>()</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>suspected_offenses_sf_joined <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    (suspected_offenses_sf <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fiscal_year)),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    thai_admin1_sf,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_as_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modify" class="level4">
<h4 class="anchored" data-anchor-id="modify">Modify</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>offences_sf_by_province_year <span class="ot">&lt;-</span> offences_sf_joined <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(fiscal_year,province_en,ADM1_PCODE, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total_cases =</span> <span class="fu">sum</span>(no_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>suspected_offences_sf_by_province_year <span class="ot">&lt;-</span> suspected_offenses_sf_joined <span class="sc">%&gt;%</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(fiscal_year,province_en,ADM1_PCODE, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total_cases =</span> <span class="fu">sum</span>(no_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><code>.groups = "drop"</code> avoids creating unnecessary group structure</p>
</blockquote>
</section>
<section id="check" class="level3">
<h3 class="anchored" data-anchor-id="check">Check</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(offences_sf_by_province_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 462
Columns: 5
$ fiscal_year &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017…
$ province_en &lt;chr&gt; "AMNAT CHAROEN", "ANG THONG", "BANGKOK", "BUENG KAN", "BUR…
$ ADM1_PCODE  &lt;chr&gt; "37", "15", "10", "38", "31", "24", "18", "36", "22", "50"…
$ geometry    &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((104.9598 16..., MULTIPOLYGON …
$ total_cases &lt;dbl&gt; 2499, 748, 28747, 2070, 2411, 4566, 729, 3134, 1952, 7438,…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(suspected_offences_sf_by_province_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 462
Columns: 5
$ fiscal_year &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017…
$ province_en &lt;chr&gt; "AMNAT CHAROEN", "ANG THONG", "BANGKOK", "BUENG KAN", "BUR…
$ ADM1_PCODE  &lt;chr&gt; "37", "15", "10", "38", "31", "24", "18", "36", "22", "50"…
$ geometry    &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((104.9598 16..., MULTIPOLYGON …
$ total_cases &lt;dbl&gt; 2577, 866, 31320, 2242, 2650, 4752, 807, 3301, 2069, 8182,…</code></pre>
</div>
</div>
</section>
<section id="visualise-using-tmap" class="level3">
<h3 class="anchored" data-anchor-id="visualise-using-tmap">Visualise using <code>tmap</code></h3>
<p>As previously plotted, the distribution of drug offenses in Thailand (across time periods and within province areas) is characteristic of a <strong>right-skewed distribution</strong> or <strong>heavy-tailed</strong> distribution. Hence, a <strong>logarithmic scale</strong> or a <strong>Jenks Natural Breaks</strong> method would be suitable to handle the skewness and emphasize meaningful breaks in the data.</p>
<section id="log" class="level4">
<h4 class="anchored" data-anchor-id="log">Log</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(offences_sf_by_province_year) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Blues"</span>,       <span class="co"># Use a blue color palette similar to the image</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"log10"</span>,      <span class="co"># Adjust based on the distribution of your data</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">5</span>,                   <span class="co"># Define number of bins for colors</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Drug use cases"</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Facet by year, 2 rows and 3 columns</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Drug use cases by year"</span>,               <span class="co"># Title for the entire plot</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),         <span class="co"># Position the legend on the right</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.size =</span> <span class="fl">1.333</span>,                         <span class="co"># Adjust the size of the year labels</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.size =</span> .<span class="dv">666</span>,                        <span class="co"># Customize the size of the legend title</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> .<span class="dv">666</span>                          <span class="co"># Customize the size of the legend text</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(suspected_offences_sf_by_province_year) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Blues"</span>,       <span class="co"># Use a blue color palette similar to the image</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"log10"</span>,      <span class="co"># Adjust based on the distribution of your data</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">5</span>,                   <span class="co"># Define number of bins for colors</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Suspected Drug uses"</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Facet by year, 2 rows and 3 columns</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Suspected Drug uses by year"</span>,               <span class="co"># Title for the entire plot</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),         <span class="co"># Position the legend on the right</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.size =</span> <span class="fl">1.333</span>,                         <span class="co"># Adjust the size of the year labels</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.size =</span> .<span class="dv">666</span>,                        <span class="co"># Customize the size of the legend title</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> .<span class="dv">666</span>                          <span class="co"># Customize the size of the legend text</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="jenks" class="level4">
<h4 class="anchored" data-anchor-id="jenks">Jenks</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(offences_sf_by_province_year) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Blues"</span>,       <span class="co"># Use a blue color palette similar to the image</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"jenks"</span>,      <span class="co"># Adjust based on the distribution of your data</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">5</span>,                   <span class="co"># Define number of bins for colors</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Drug use cases"</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Facet by year, 2 rows and 3 columns</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Drug use cases by year"</span>,               <span class="co"># Title for the entire plot</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),         <span class="co"># Position the legend on the right</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.size =</span> <span class="fl">1.333</span>,                         <span class="co"># Adjust the size of the year labels</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.size =</span> .<span class="dv">666</span>,                        <span class="co"># Customize the size of the legend title</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> .<span class="dv">666</span>                          <span class="co"># Customize the size of the legend text</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(suspected_offences_sf_by_province_year) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"total_cases"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Blues"</span>,       <span class="co"># Use a blue color palette similar to the image</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"jenks"</span>,      <span class="co"># Adjust based on the distribution of your data</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">5</span>,                   <span class="co"># Define number of bins for colors</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Suspected Drug uses"</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Facet by year, 2 rows and 3 columns</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Suspected Drug uses by year"</span>,               <span class="co"># Title for the entire plot</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),         <span class="co"># Position the legend on the right</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.label.size =</span> <span class="fl">1.333</span>,                         <span class="co"># Adjust the size of the year labels</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.size =</span> .<span class="dv">666</span>,                        <span class="co"># Customize the size of the legend title</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> .<span class="dv">666</span>                          <span class="co"># Customize the size of the legend text</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Jenks has better contrast between hot and cold spots overall compared to the logarithmic method</p>
</blockquote>
</section>
</section>
</section>
</section>
<section id="visualising-drug-abuse-indicators" class="level1">
<h1>Visualising Drug Abuse Indicators</h1>
<section id="prepare-layers" class="level3">
<h3 class="anchored" data-anchor-id="prepare-layers">Prepare layers</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>drug_use    <span class="ot">&lt;-</span> offenses_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(types_of_drug_offenses<span class="sc">==</span><span class="st">'drug_use_cases'</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>possession  <span class="ot">&lt;-</span> offenses_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(types_of_drug_offenses<span class="sc">==</span><span class="st">'possession_cases'</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>possession_with_intent_to_distribute <span class="ot">&lt;-</span> offenses_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(types_of_drug_offenses<span class="sc">==</span><span class="st">'possession_with_intent_to_distribute_cases'</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>trafficking <span class="ot">&lt;-</span> offenses_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(types_of_drug_offenses<span class="sc">==</span><span class="st">'trafficking_cases'</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>production  <span class="ot">&lt;-</span> offenses_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(types_of_drug_offenses<span class="sc">==</span><span class="st">'production_cases'</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>import      <span class="ot">&lt;-</span> offenses_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(types_of_drug_offenses<span class="sc">==</span><span class="st">'import_cases'</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>export      <span class="ot">&lt;-</span> offenses_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(types_of_drug_offenses<span class="sc">==</span><span class="st">'export_cases'</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>conspiracy  <span class="ot">&lt;-</span> offenses_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(types_of_drug_offenses<span class="sc">==</span><span class="st">'conspiracy_cases'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>drug_use    <span class="ot">&lt;-</span> <span class="fu">left_join</span>(drug_use, thai_admin1_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>possession  <span class="ot">&lt;-</span> <span class="fu">left_join</span>(possession, thai_admin1_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>possession_with_intent_to_distribute <span class="ot">&lt;-</span> <span class="fu">left_join</span>(possession_with_intent_to_distribute, thai_admin1_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>trafficking <span class="ot">&lt;-</span> <span class="fu">left_join</span>(trafficking, thai_admin1_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>production  <span class="ot">&lt;-</span> <span class="fu">left_join</span>(production, thai_admin1_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>))</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>import      <span class="ot">&lt;-</span> <span class="fu">left_join</span>(import, thai_admin1_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>export      <span class="ot">&lt;-</span> <span class="fu">left_join</span>(export, thai_admin1_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>))</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>conspiracy  <span class="ot">&lt;-</span> <span class="fu">left_join</span>(conspiracy, thai_admin1_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'province_en'</span><span class="ot">=</span><span class="st">'ADM1_EN'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rds-checkpoint" class="level3">
<h3 class="anchored" data-anchor-id="rds-checkpoint">RDS Checkpoint</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(drug_use, <span class="st">'data/rds/drug_use.rds'</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(possession, <span class="st">'data/rds/possession.rds'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(possession_with_intent_to_distribute, <span class="st">'data/rds/possession_with_intent_to_distribute.rds'</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(trafficking, <span class="st">'data/rds/trafficking.rds'</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(production, <span class="st">'data/rds/production.rds'</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(import, <span class="st">'data/rds/import.rds'</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(export, <span class="st">'data/rds/export.rds'</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(conspiracy, <span class="st">'data/rds/conspiracy.rds'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>drug_use <span class="ot">=</span>    <span class="fu">read_rds</span>(<span class="st">'data/rds/drug_use.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>possession <span class="ot">=</span>  <span class="fu">read_rds</span>(<span class="st">'data/rds/possession.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>possession_with_intent_to_distribute <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="st">'data/rds/possession_with_intent_to_distribute.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>trafficking <span class="ot">=</span> <span class="fu">read_rds</span>(<span class="st">'data/rds/trafficking.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>production <span class="ot">=</span>  <span class="fu">read_rds</span>(<span class="st">'data/rds/production.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>import <span class="ot">=</span>      <span class="fu">read_rds</span>(<span class="st">'data/rds/import.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>export <span class="ot">=</span>      <span class="fu">read_rds</span>(<span class="st">'data/rds/export.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>conspiracy <span class="ot">=</span>  <span class="fu">read_rds</span>(<span class="st">'data/rds/conspiracy.rds'</span>) <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualise" class="level3">
<h3 class="anchored" data-anchor-id="visualise">Visualise</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">drug use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">possession</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">possession with intent to distribute</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">trafficking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-7" role="tab" aria-controls="tabset-4-7" aria-selected="false">export</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-8" role="tab" aria-controls="tabset-4-8" aria-selected="false">conspiracy</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(drug_use<span class="sc">$</span>no_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    32 16480</code></pre>
</div>
</div>
<blockquote class="blockquote">
<ul>
<li><p>Significant spread: quantile or log10 to prevent extreme outlier/values from overshadowing smaller ones</p></li>
<li><p>yellow-orange-red sequential gradient to highlight hotspots</p></li>
</ul>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(drug_use) <span class="sc">+</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Drug Use Cases"</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"[quantile] Drug Use Cases by Province (2017-2022)"</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "[quantile] Drug Use Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(drug_use) <span class="sc">+</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"log10"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Drug Use Cases"</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-50-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"[log10] Drug Use Cases by Province (2017-2022)"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "[log10] Drug Use Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Turns out log10 does not produce a well-contrasted chloropleth map</p>
</blockquote>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(possession<span class="sc">$</span>no_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    87 10643</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Same settings, same rationale as <code>drug_use</code></p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(possession) <span class="sc">+</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Possession Cases"</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Possession Cases by Province (2017-2022)"</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "Possession Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(possession) <span class="sc">+</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"log10"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Possession Cases"</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Possession by Province (2017-2022)"</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "Possession by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(possession_with_intent_to_distribute<span class="sc">$</span>no_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   39 6374</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Smaller range compared to <code>drug_use</code> and <code>possession</code>, so <code>quantile</code> can provide a good balance without compressing the data into a narrow visual range, possibly <code>jenks</code> too?</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(possession_with_intent_to_distribute) <span class="sc">+</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"possession_with_intent_to_distribute Cases"</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"possession_with_intent_to_distribute Cases by Province (2017-2022)"</span>,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "possession_with_intent_to_distribute Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(possession_with_intent_to_distribute) <span class="sc">+</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"possession_with_intent_to_distribute Cases"</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-54-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"possession_with_intent_to_distribute Cases by Province (2017-2022)"</span>,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "possession_with_intent_to_distribute Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(trafficking<span class="sc">$</span>no_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    3 1190</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Much smaller and more clustered range thus far. Using <code>jenks</code> should help discern significant differences without skewness.</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(trafficking) <span class="sc">+</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"trafficking Cases"</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"trafficking Cases by Province (2017-2022)"</span>,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "trafficking Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(trafficking) <span class="sc">+</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"trafficking Cases"</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-56-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"trafficking Cases by Province (2017-2022)"</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "trafficking Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(production<span class="sc">$</span>no_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    1 1893</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Same settings and rationale as trafficking</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(production) <span class="sc">+</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"production Cases"</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"production Cases by Province (2017-2022)"</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "production Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(production) <span class="sc">+</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"production Cases"</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-58-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"production Cases by Province (2017-2022)"</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "production Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(import<span class="sc">$</span>no_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0 77</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Small range: pretty (default) should suffice since there aren’t many useful data points anyways</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(import) <span class="sc">+</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">4</span>,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"import Cases"</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"import Cases by Province (2017-2022)"</span>,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "import Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
</div>
<div id="tabset-4-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(export<span class="sc">$</span>no_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0 11</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Same settings and rationale as import</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(export) <span class="sc">+</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">2</span>,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"export Cases"</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"export Cases by Province (2017-2022)"</span>,</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "export Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
</div>
<div id="tabset-4-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(conspiracy<span class="sc">$</span>no_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0 44</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Same settings and rationale as import</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(conspiracy) <span class="sc">+</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"no_cases"</span>,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Purples"</span>,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">3</span>,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"conspiracy Cases"</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"conspiracy Cases by Province (2017-2022)"</span>,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame =</span> <span class="cn">FALSE</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$tm_layout
$tm_layout$title
[1] "conspiracy Cases by Province (2017-2022)"

$tm_layout$frame
[1] FALSE

$tm_layout$legend.outside
[1] TRUE

$tm_layout$style
[1] NA


attr(,"class")
[1] "tm"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="global-spatial-autocorrelation-analysis" class="level1">
<h1>Global Spatial Autocorrelation Analysis</h1>
<p>Normally, spatial weights can be computed using functions like <code>poly2nb()</code> (for polygons) or <code>knn2nb()</code> (for point data), but here we need to account for the time dimension as well.</p>
<p>However I will perform it normally as discussed in class lectures and exercises.</p>
<section id="global-morans-i-with-permutation-testing" class="level2">
<h2 class="anchored" data-anchor-id="global-morans-i-with-permutation-testing">Global Moran’s I with permutation testing</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">drug_use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">possession</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">possession_with_intent_to_distribute</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">trafficking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false">import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false">export</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-8" role="tab" aria-controls="tabset-5-8" aria-selected="false">conspiracy</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>drug_use_cases <span class="ot">&lt;-</span> drug_use <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  mi_perm <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    drug_use_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(mi_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(mi_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Moran's I"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>mi_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.0822"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.0952"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.141"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: -0.0227"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.1816"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: -0.0744"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With the exception of 2020 and 2022, the observed Moran’s I is positive and significantly larger than the most of the Moran’s I values in the simulated distribution, which suggests clustering, meaning areas with high cases tend to be near other areas with high cases.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>possession_cases <span class="ot">&lt;-</span> possession <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  mi_perm <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    possession_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(mi_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(mi_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Moran's I"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>mi_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.3132"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.2765"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.3724"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.3694"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.1969"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: -0.0827"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With the exception of 2022, the observed Moran’s I is greatly positive and significantly larger than the most of the Moran’s I values in the simulated distribution, which suggests <strong>strong clustering</strong>, meaning areas with high cases tend to be near other areas with high cases.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>possession_with_intent_to_distribute_cases <span class="ot">&lt;-</span> possession_with_intent_to_distribute <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  mi_perm <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    possession_with_intent_to_distribute_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(mi_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(mi_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Moran's I"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>mi_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.1581"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.1801"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.163"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.1161"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.1722"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: -0.0264"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With the exception of 2022, the observed Moran’s I is greatly positive and significantly larger than the most of the Moran’s I values in the simulated distribution, which suggests <strong>strong clustering</strong>, meaning areas with high cases tend to be near other areas with high cases.</p>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>trafficking_cases <span class="ot">&lt;-</span> trafficking <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  mi_perm <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>    trafficking_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(mi_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(mi_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Moran's I"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>mi_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.123"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.1232"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.1876"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.0776"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.0597"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: -0.064"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With the exception of 2022, the observed Moran’s I is positive and significantly larger than the most of the Moran’s I values in the simulated distribution, which suggests <strong>clustering</strong>, meaning areas with high cases tend to be near other areas with high cases.</p>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>production_cases <span class="ot">&lt;-</span> production <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  mi_perm <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    production_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(mi_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(mi_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Moran's I"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>mi_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.5561"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.51"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.3899"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.2683"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.421"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: 0.0211"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With the exception of 2022, the observed Moran’s I is greatly positive and significantly larger than the most of the Moran’s I values in the simulated distribution, which suggests <strong>strong clustering</strong>, meaning areas with high cases tend to be near other areas with high cases.</p>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>import_cases <span class="ot">&lt;-</span> import <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  mi_perm <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>    import_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(mi_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(mi_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Moran's I"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>mi_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.2107"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.2143"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.1895"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.1309"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.0972"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: -0.0598"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With the exception of 2022, the observed Moran’s I is greatly positive and significantly larger than the most of the Moran’s I values in the simulated distribution, which suggests <strong>strong clustering</strong>, meaning areas with high cases tend to be near other areas with high cases.</p>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>export_cases <span class="ot">&lt;-</span> export <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  mi_perm <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    export_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(mi_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(mi_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Moran's I"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>mi_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: -0.0502"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.0076"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.0792"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: -0.0668"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: -0.071"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: -0.0208"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This had an unusual pattern compared to the rest. With the exception of 2018 and 2019, the observed Moran’s I is <strong>negative</strong> and smaller than the most of the Moran’s I values in the simulated distribution, which suggests a more dispersed, <strong>checkerboard</strong> spatial pattern, where high and low number of cases alternate spatially.</p>
</div>
<div id="tabset-5-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-8-tab">
<blockquote class="blockquote">
<p>Had to account for the years with 0 cases</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>conspiracy_cases <span class="ot">&lt;-</span> conspiracy <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>  cases <span class="ot">=</span> conspiracy_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>  mi_perm <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x = integer(nrow(wm_q)),</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>    cases,</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># debugging</span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(year)</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(cases)</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># checks if the year's vector has no_case = 0</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(cases)<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Skipping year"</span>, year, <span class="st">"due to empty data (0 cases)"</span>))</span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>  <span class="co"># continue to next iteration</span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(mi_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(mi_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Moran's I"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>mi_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.1216"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.207"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.0162"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.0168"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping year 2021 due to empty data (0 cases)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping year 2022 due to empty data (0 cases)</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The observed Moran’s I is positive and significantly larger than the most of the Moran’s I values in the simulated distribution, which suggests <strong>clustering</strong>, meaning areas with high cases tend to be near other areas with high cases.</p>
</div>
</div>
</div>
</section>
<section id="gearys-c" class="level2">
<h2 class="anchored" data-anchor-id="gearys-c">Geary’s C</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">drug_use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">possession</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">possession_with_intent_to_distribute</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">trafficking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-7" role="tab" aria-controls="tabset-6-7" aria-selected="false">export</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-8" role="tab" aria-controls="tabset-6-8" aria-selected="false">conspiracy</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  gc_perm <span class="ot">&lt;-</span> <span class="fu">global_c_perm</span>(</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>    drug_use_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(gc_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(gc_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Geary's C"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>gc_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 1.0258"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 1.0037"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.9167"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 1.14"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.7809"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: 1.0367"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>C &lt; 1 for 2019, 2021: stronger positive spatial autocorrelation (cases of similar values group together spatially)</p>
<p>C ~ 1 for 2017, 2018: no significant spatial autocorrelation (case values are randomly distributed spatially)</p>
<p>C &gt; 1 for 2020, 2022: stronger negative spatial autocorrelation (cases of dissimilar values group together spatially)</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  gc_perm <span class="ot">&lt;-</span> <span class="fu">global_c_perm</span>(</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>    possession_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(gc_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(gc_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Geary's C"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>gc_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.7603"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.8117"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.6932"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.7879"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.7613"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: 1.0432"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>C &lt; 1 for 2017, 2018, 2019, 2020, 2021: stronger positive spatial autocorrelation (cases of similar values group together spatially)</p>
<p>C &gt; 1 for 2022: stronger negative spatial autocorrelation (cases of dissimilar values group together spatially)</p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  gc_perm <span class="ot">&lt;-</span> <span class="fu">global_c_perm</span>(</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    possession_with_intent_to_distribute_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(gc_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(gc_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Geary's C"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>gc_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.9771"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.9372"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.9403"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 1.0417"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.7518"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: 1.0646"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Same pattern as drug_use</p>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  gc_perm <span class="ot">&lt;-</span> <span class="fu">global_c_perm</span>(</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>    trafficking_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(gc_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(gc_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Geary's C"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>gc_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.9121"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.8823"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.7766"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.9155"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.8283"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: 1.0195"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Same pattern as possession</p>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  gc_perm <span class="ot">&lt;-</span> <span class="fu">global_c_perm</span>(</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>    production_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(gc_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(gc_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Geary's C"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>gc_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.5471"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.5773"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.6932"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 0.7544"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.5693"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: 0.9292"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>C &lt; 1 for <strong>all years</strong>: strong positive spatial autocorrelation (cases of similar values group together spatially)</p>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>  gc_perm <span class="ot">&lt;-</span> <span class="fu">global_c_perm</span>(</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>    import_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(gc_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(gc_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Geary's C"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>gc_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.9166"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.7272"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.939"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 1.0753"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 1.0812"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: 1.0938"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>C &lt; 1 for 2017 to 2019: stronger positive spatial autocorrelation (cases of similar values group together spatially)</p>
<p>C &gt; 1 for 2020 to 2022: stronger negative spatial autocorrelation (cases of dissimilar values group together spatially)</p>
</div>
<div id="tabset-6-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  gc_perm <span class="ot">&lt;-</span> <span class="fu">global_c_perm</span>(</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>    export_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(gc_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(gc_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Geary's C"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>gc_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 1.0594"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.9383"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 0.6677"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 1.0626"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 statistic: 0.9808"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 statistic: 1.0983"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>C &lt; 1 for 2018, 2019: stronger positive spatial autocorrelation (cases of similar values group together spatially)</p>
<p>C ~ 1 for 2021: no significant spatial autocorrelation (case values are randomly distributed spatially)</p>
<p>C &gt; 1 for 2017, 2020, 2022: stronger negative spatial autocorrelation (cases of dissimilar values group together spatially)</p>
</div>
<div id="tabset-6-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-8-tab">
<blockquote class="blockquote">
<p>Had to account for the years with 0 cases</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  cases <span class="ot">=</span> conspiracy_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>)</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  gc_perm <span class="ot">&lt;-</span> <span class="fu">global_c_perm</span>(</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x = integer(nrow(wm_q)),</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>    cases,</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>    wm_q<span class="sc">$</span>wt,</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>)</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># debugging</span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(year)</span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(cases)</span></span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># checks if the year's vector has no_case = 0</span></span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(cases)<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Skipping year"</span>, year, <span class="st">"due to empty data (0 cases)"</span>))</span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>  <span class="co"># continue to next iteration</span></span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"statistic:"</span>,<span class="fu">round</span>(gc_perm<span class="sc">$</span>statistic,<span class="dv">4</span>)))</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(gc_perm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Simulated Geary's C"</span>), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram for"</span>, year))</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>gc_perm<span class="sc">$</span>statistic,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 statistic: 0.9139"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 statistic: 0.852"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 statistic: 1.1644"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 statistic: 1.2466"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping year 2021 due to empty data (0 cases)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping year 2022 due to empty data (0 cases)</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>C &lt; 1 for 2017, 2018: stronger positive spatial autocorrelation (cases of similar values group together spatially)</p>
<p>C &gt; 1 for 2019, 2020: stronger negative spatial autocorrelation (cases of dissimilar values group together spatially)</p>
</div>
</div>
</div>
</section>
<section id="spatial-correlogram" class="level2">
<h2 class="anchored" data-anchor-id="spatial-correlogram">Spatial Correlogram</h2>
<section id="morans-i" class="level3">
<h3 class="anchored" data-anchor-id="morans-i">Moran’s I</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">drug use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">possession</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">possession with intent to distribute</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">trafficking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-6" role="tab" aria-controls="tabset-7-6" aria-selected="false">import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-7" role="tab" aria-controls="tabset-7-7" aria-selected="false">export</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-8" role="tab" aria-controls="tabset-7-8" aria-selected="false">conspiracy</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  MI_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>    drug_use_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"I"</span>, </span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(MI_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"drug_use_cases"</span>))</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(MI_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided
1 (77)  0.0821634  -0.0131579  0.0036650           1.5745          0.1154
2 (76)  0.0266710  -0.0133333  0.0022351           0.8462          0.3975
3 (77) -0.0324661  -0.0131579  0.0017748          -0.4583          0.6467
4 (77)  0.0156920  -0.0131579  0.0018770           0.6659          0.5055
5 (77) -0.0599058  -0.0131579  0.0021004          -1.0200          0.3077
6 (77) -0.0164010  -0.0131579  0.0029873          -0.0593          0.9527</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.0952025  -0.0131579  0.0039477           1.7246         0.08459 .
2 (76)  0.0074005  -0.0133333  0.0024110           0.4223         0.67283  
3 (77) -0.0114557  -0.0131579  0.0019106           0.0389         0.96894  
4 (77)  0.0345456  -0.0131579  0.0020195           1.0615         0.28846  
5 (77) -0.0693915  -0.0131579  0.0022563          -1.1839         0.23647  
6 (77) -0.0250539  -0.0131579  0.0032047          -0.2101         0.83356  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.1410203  -0.0131579  0.0050350           2.1728         0.02979 *
2 (76) -0.0225695  -0.0133333  0.0030875          -0.1662         0.86798  
3 (77)  0.0020717  -0.0131579  0.0024333           0.3087         0.75752  
4 (77)  0.0415944  -0.0131579  0.0025679           1.0805         0.27993  
5 (77) -0.0673589  -0.0131579  0.0028562          -1.0142         0.31050  
6 (77) -0.0191477  -0.0131579  0.0040411          -0.0942         0.92493  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided
1 (77) -0.0226885  -0.0131579  0.0053015          -0.1309          0.8959
2 (76) -0.0176267  -0.0133333  0.0032532          -0.0753          0.9400
3 (77)  0.0331893  -0.0131579  0.0025614           0.9158          0.3598
4 (77) -0.0046441  -0.0131579  0.0027023           0.1638          0.8699
5 (77) -0.0085435  -0.0131579  0.0030032           0.0842          0.9329
6 (77) -0.0809329  -0.0131579  0.0042461          -1.0401          0.2983</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77)  0.1815510  -0.0131579  0.0057689           2.5635        0.010361 * 
2 (76)  0.0798288  -0.0133333  0.0035441           1.5649        0.117604   
3 (77) -0.1156738  -0.0131579  0.0027860          -1.9422        0.052111 . 
4 (77)  0.1598054  -0.0131579  0.0029380           3.1910        0.001418 **
5 (77) -0.1386056  -0.0131579  0.0032611          -2.1968        0.028038 * 
6 (77) -0.2031245  -0.0131579  0.0046057          -2.7992        0.005123 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided
1 (77) -0.0743724  -0.0131579  0.0058364          -0.8013          0.4230
2 (76) -0.0517227  -0.0133333  0.0035860          -0.6411          0.5215
3 (77) -0.0823651  -0.0131579  0.0028185          -1.3036          0.1924
4 (77)  0.0441815  -0.0131579  0.0029720           1.0518          0.2929
5 (77)  0.0524637  -0.0131579  0.0032983           1.1426          0.2532
6 (77) -0.0327280  -0.0131579  0.0046576          -0.2868          0.7743</code></pre>
</div>
</div>
<p>2017 - 2019, 2021: <strong>Significant</strong> <strong>Short-distance Positive Correlation</strong> (High Moran’s I values at low lags) suggests a <strong>clustered pattern; Significant</strong> <strong>Long-distance Negative Correlation</strong> (Negative Moran’s I values at larger distances) suggest that <strong>dissimilar</strong> values are found near each other</p>
<p>2020, 2022: Correlogram is flat and close to zero across all distances, suggests <strong>no significant spatial autocorrelation</strong> at any lag, meaning that the spatial distribution of values is <strong>random</strong></p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  MI_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>    possession_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"I"</span>, </span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(MI_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"possession_cases"</span>))</span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(MI_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.3132301  -0.0131579  0.0048723           4.6759       2.926e-06 ***
2 (76)  0.1532018  -0.0133333  0.0029862           3.0475        0.002308 ** 
3 (77)  0.1007286  -0.0131579  0.0023551           2.3468        0.018937 *  
4 (77)  0.0240663  -0.0131579  0.0024859           0.7466        0.455306    
5 (77) -0.0206022  -0.0131579  0.0027664          -0.1415        0.887448    
6 (77)  0.0213155  -0.0131579  0.0039160           0.5509        0.581710    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.2764915  -0.0131579  0.0045216           4.3075       1.651e-05 ***
2 (76)  0.1290588  -0.0133333  0.0027681           2.7064        0.006801 ** 
3 (77)  0.0746536  -0.0131579  0.0021865           1.8779        0.060394 .  
4 (77)  0.0410845  -0.0131579  0.0023090           1.1288        0.258972    
5 (77) -0.0156378  -0.0131579  0.0025730          -0.0489        0.961007    
6 (77)  0.0240339  -0.0131579  0.0036462           0.6159        0.537947    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.3723814  -0.0131579  0.0050578           5.4211       5.922e-08 ***
2 (76)  0.1432547  -0.0133333  0.0031016           2.8117        0.004928 ** 
3 (77)  0.0722020  -0.0131579  0.0024442           1.7266        0.084245 .  
4 (77)  0.0079637  -0.0131579  0.0025794           0.4159        0.677497    
5 (77) -0.0386579  -0.0131579  0.0028687          -0.4761        0.634006    
6 (77)  0.0104707  -0.0131579  0.0040586           0.3709        0.710717    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
          estimate expectation    variance standard deviate Pr(I) two sided    
1 (77)  0.36942323 -0.01315789  0.00524894           5.2807       1.287e-07 ***
2 (76)  0.10694259 -0.01333333  0.00322055           2.1194         0.03406 *  
3 (77)  0.00081767 -0.01315789  0.00253611           0.2775         0.78139    
4 (77)  0.00941161 -0.01315789  0.00267579           0.4363         0.66261    
5 (77) -0.04853504 -0.01315789  0.00297422          -0.6487         0.51654    
6 (77) -0.12691678 -0.01315789  0.00420568          -1.7542         0.07940 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.1969197  -0.0131579  0.0054673           2.8412        0.004495 ** 
2 (76)  0.2006583  -0.0133333  0.0033564           3.6937        0.000221 ***
3 (77)  0.1348548  -0.0131579  0.0026410           2.8801        0.003975 ** 
4 (77)  0.3850645  -0.0131579  0.0027859           7.5447       4.532e-14 ***
5 (77) -0.0169954  -0.0131579  0.0030947          -0.0690        0.945003    
6 (77) -0.1341956  -0.0131579  0.0043736          -1.8302        0.067219 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided
1 (77) -0.0827032  -0.0131579  0.0058006          -0.9131          0.3612
2 (76) -0.0338451  -0.0133333  0.0035638          -0.3436          0.7312
3 (77) -0.0774696  -0.0131579  0.0028013          -1.2151          0.2243
4 (77)  0.0626648  -0.0131579  0.0029540           1.3951          0.1630
5 (77) -0.0262732  -0.0131579  0.0032786          -0.2291          0.8188
6 (77) -0.0190224  -0.0131579  0.0046300          -0.0862          0.9313</code></pre>
</div>
</div>
<p>2017 - 2021: <strong>Significant</strong> <strong>Short-distance Positive Correlation</strong> (High Moran’s I values at low lags) suggests a <strong>clustered pattern; Significant</strong> <strong>Long-distance Negative Correlation</strong> (Negative Moran’s I values at larger distances) suggest that <strong>dissimilar</strong> values are found near each other</p>
<p>2022: Correlogram is flat and close to zero across all distances, suggests <strong>no significant spatial autocorrelation</strong> at any lag, meaning that the spatial distribution of values is <strong>random</strong></p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>  MI_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>    possession_with_intent_to_distribute_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"I"</span>, </span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(MI_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"possession_with_intent_to_distribute_cases"</span>))</span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(MI_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77)  0.1580999  -0.0131579  0.0031630           3.0451        0.002326 **
2 (76)  0.0162369  -0.0133333  0.0019227           0.6744        0.500080   
3 (77) -0.0609857  -0.0131579  0.0015335          -1.2214        0.221951   
4 (77) -0.0268098  -0.0131579  0.0016238          -0.3388        0.734771   
5 (77) -0.0409738  -0.0131579  0.0018234          -0.6514        0.514781   
6 (77) -0.0206921  -0.0131579  0.0026011          -0.1477        0.882559   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77)  0.1801406  -0.0131579  0.0039007           3.0950        0.001968 **
2 (76) -0.0022833  -0.0133333  0.0023817           0.2264        0.820873   
3 (77) -0.0674658  -0.0131579  0.0018880          -1.2498        0.211356   
4 (77) -0.0225452  -0.0131579  0.0019958          -0.2101        0.833571   
5 (77) -0.0287503  -0.0131579  0.0022304          -0.3302        0.741279   
6 (77) -0.0223764  -0.0131579  0.0031685          -0.1638        0.869913   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77)  0.1630313  -0.0131579  0.0045084           2.6240         0.00869 **
2 (76) -0.0506937  -0.0133333  0.0027598          -0.7112         0.47698   
3 (77) -0.0808850  -0.0131579  0.0021802          -1.4505         0.14692   
4 (77) -0.0283234  -0.0131579  0.0023023          -0.3161         0.75196   
5 (77) -0.0015985  -0.0131579  0.0025657           0.2282         0.81948   
6 (77) -0.0272291  -0.0131579  0.0036360          -0.2334         0.81549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.1160863  -0.0131579  0.0051706           1.7974         0.07227 .
2 (76)  0.0882911  -0.0133333  0.0031718           1.8045         0.07116 .
3 (77)  0.0445712  -0.0131579  0.0024984           1.1549         0.24811  
4 (77) -0.0176631  -0.0131579  0.0026363          -0.0877         0.93008  
5 (77) -0.1050787  -0.0131579  0.0029310          -1.6979         0.08953 .
6 (77) -0.1202366  -0.0131579  0.0041454          -1.6631         0.09629 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.1722358  -0.0131579  0.0058253           2.4290       0.0151390 *  
2 (76)  0.0812325  -0.0133333  0.0035792           1.5807       0.1139518    
3 (77) -0.0383423  -0.0131579  0.0028132          -0.4748       0.6349113    
4 (77)  0.1874144  -0.0131579  0.0029665           3.6826       0.0002309 ***
5 (77) -0.0765379  -0.0131579  0.0032922          -1.1046       0.2693299    
6 (77) -0.1956846  -0.0131579  0.0046491          -2.6770       0.0074291 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77) -0.0264389  -0.0131579  0.0057183          -0.1756         0.86058  
2 (76) -0.1012529  -0.0133333  0.0035126          -1.4835         0.13795  
3 (77)  0.0149777  -0.0131579  0.0027617           0.5354         0.59238  
4 (77) -0.0282964  -0.0131579  0.0029125          -0.2805         0.77909  
5 (77)  0.0770946  -0.0131579  0.0032332           1.5872         0.11246  
6 (77) -0.1370510  -0.0131579  0.0045667          -1.8333         0.06675 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>For all years,</p>
<p><strong>Significant</strong> <strong>Short-distance Positive Correlation</strong> (High Moran’s I values at low lags) suggests a <strong>clustered pattern; Significant</strong> <strong>Long-distance Negative Correlation</strong> (Negative Moran’s I values at larger distances) suggest that <strong>dissimilar</strong> values are found near each other.</p>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  MI_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>    possession_with_intent_to_distribute_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"I"</span>, </span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(MI_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"possession_with_intent_to_distribute_cases"</span>))</span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(MI_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77)  0.1580999  -0.0131579  0.0031630           3.0451        0.002326 **
2 (76)  0.0162369  -0.0133333  0.0019227           0.6744        0.500080   
3 (77) -0.0609857  -0.0131579  0.0015335          -1.2214        0.221951   
4 (77) -0.0268098  -0.0131579  0.0016238          -0.3388        0.734771   
5 (77) -0.0409738  -0.0131579  0.0018234          -0.6514        0.514781   
6 (77) -0.0206921  -0.0131579  0.0026011          -0.1477        0.882559   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77)  0.1801406  -0.0131579  0.0039007           3.0950        0.001968 **
2 (76) -0.0022833  -0.0133333  0.0023817           0.2264        0.820873   
3 (77) -0.0674658  -0.0131579  0.0018880          -1.2498        0.211356   
4 (77) -0.0225452  -0.0131579  0.0019958          -0.2101        0.833571   
5 (77) -0.0287503  -0.0131579  0.0022304          -0.3302        0.741279   
6 (77) -0.0223764  -0.0131579  0.0031685          -0.1638        0.869913   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77)  0.1630313  -0.0131579  0.0045084           2.6240         0.00869 **
2 (76) -0.0506937  -0.0133333  0.0027598          -0.7112         0.47698   
3 (77) -0.0808850  -0.0131579  0.0021802          -1.4505         0.14692   
4 (77) -0.0283234  -0.0131579  0.0023023          -0.3161         0.75196   
5 (77) -0.0015985  -0.0131579  0.0025657           0.2282         0.81948   
6 (77) -0.0272291  -0.0131579  0.0036360          -0.2334         0.81549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.1160863  -0.0131579  0.0051706           1.7974         0.07227 .
2 (76)  0.0882911  -0.0133333  0.0031718           1.8045         0.07116 .
3 (77)  0.0445712  -0.0131579  0.0024984           1.1549         0.24811  
4 (77) -0.0176631  -0.0131579  0.0026363          -0.0877         0.93008  
5 (77) -0.1050787  -0.0131579  0.0029310          -1.6979         0.08953 .
6 (77) -0.1202366  -0.0131579  0.0041454          -1.6631         0.09629 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.1722358  -0.0131579  0.0058253           2.4290       0.0151390 *  
2 (76)  0.0812325  -0.0133333  0.0035792           1.5807       0.1139518    
3 (77) -0.0383423  -0.0131579  0.0028132          -0.4748       0.6349113    
4 (77)  0.1874144  -0.0131579  0.0029665           3.6826       0.0002309 ***
5 (77) -0.0765379  -0.0131579  0.0032922          -1.1046       0.2693299    
6 (77) -0.1956846  -0.0131579  0.0046491          -2.6770       0.0074291 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77) -0.0264389  -0.0131579  0.0057183          -0.1756         0.86058  
2 (76) -0.1012529  -0.0133333  0.0035126          -1.4835         0.13795  
3 (77)  0.0149777  -0.0131579  0.0027617           0.5354         0.59238  
4 (77) -0.0282964  -0.0131579  0.0029125          -0.2805         0.77909  
5 (77)  0.0770946  -0.0131579  0.0032332           1.5872         0.11246  
6 (77) -0.1370510  -0.0131579  0.0045667          -1.8333         0.06675 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Similar autocorrelation pattern and significance with possession with intent to distribute</p>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>  MI_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>    production_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"I"</span>, </span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(MI_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"production_cases"</span>))</span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(MI_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.5561174  -0.0131579  0.0043424           8.6388       &lt; 2.2e-16 ***
2 (76)  0.3961935  -0.0133333  0.0026566           7.9455       1.934e-15 ***
3 (77)  0.1971685  -0.0131579  0.0021004           4.5893       4.448e-06 ***
4 (77)  0.0595033  -0.0131579  0.0022186           1.5426          0.1229    
5 (77) -0.0104617  -0.0131579  0.0024741           0.0542          0.9568    
6 (77) -0.0415630  -0.0131579  0.0035084          -0.4796          0.6315    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
          estimate expectation    variance standard deviate Pr(I) two sided    
1 (77)  0.50997666 -0.01315789  0.00441889           7.8697       3.556e-15 ***
2 (76)  0.39172438 -0.01333333  0.00270413           7.7894       6.734e-15 ***
3 (77)  0.25346637 -0.01315789  0.00213714           5.7674       8.049e-09 ***
4 (77)  0.09427400 -0.01315789  0.00225719           2.2613         0.02374 *  
5 (77)  0.00030724 -0.01315789  0.00251628           0.2684         0.78837    
6 (77) -0.03745034 -0.01315789  0.00356719          -0.4067         0.68420    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.3899209  -0.0131579  0.0044361           6.0519       1.432e-09 ***
2 (76)  0.2850221  -0.0133333  0.0027148           5.7261       1.027e-08 ***
3 (77)  0.1984241  -0.0131579  0.0021454           4.5680       4.925e-06 ***
4 (77)  0.0618549  -0.0131579  0.0022659           1.5759          0.1151    
5 (77) -0.0154304  -0.0131579  0.0025258          -0.0452          0.9639    
6 (77) -0.0249549  -0.0131579  0.0035804          -0.1972          0.8437    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.2682891  -0.0131579  0.0052346           3.8900       0.0001002 ***
2 (76)  0.0013204  -0.0133333  0.0032116           0.2586       0.7959642    
3 (77) -0.0204744  -0.0131579  0.0025292          -0.1455       0.8843295    
4 (77)  0.0454432  -0.0131579  0.0026686           1.1344       0.2566257    
5 (77) -0.0113841  -0.0131579  0.0029663           0.0326       0.9740187    
6 (77) -0.1078964  -0.0131579  0.0041947          -1.4628       0.1435284    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.4209831  -0.0131579  0.0056304           5.7858       7.219e-09 ***
2 (76)  0.1121723  -0.0133333  0.0034579           2.1343        0.032818 *  
3 (77)  0.1273393  -0.0131579  0.0027195           2.6942        0.007056 ** 
4 (77)  0.2339539  -0.0131579  0.0028682           4.6141       3.947e-06 ***
5 (77)  0.0081866  -0.0131579  0.0031847           0.3782        0.705262    
6 (77) -0.1567977  -0.0131579  0.0044991          -2.1415        0.032237 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided
1 (77)  0.0211452  -0.0131579  0.0055824           0.4591          0.6462
2 (76) -0.0137077  -0.0133333  0.0034280          -0.0064          0.9949
3 (77) -0.0180212  -0.0131579  0.0026964          -0.0937          0.9254
4 (77)  0.0538960  -0.0131579  0.0028440           1.2574          0.2086
5 (77) -0.0614679  -0.0131579  0.0031582          -0.8596          0.3900
6 (77) -0.0792520  -0.0131579  0.0044622          -0.9894          0.3224</code></pre>
</div>
</div>
<p>Similar autocorrelation pattern and significance with possession with intent to distribute</p>
</div>
<div id="tabset-7-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  MI_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>    import_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"I"</span>, </span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(MI_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"import_cases"</span>))</span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(MI_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.2107355  -0.0131579  0.0026864           4.3197       1.562e-05 ***
2 (76)  0.0011857  -0.0133333  0.0016263           0.3600          0.7188    
3 (77) -0.0034934  -0.0131579  0.0013044           0.2676          0.7890    
4 (77) -0.0053145  -0.0131579  0.0013835           0.2109          0.8330    
5 (77) -0.0113093  -0.0131579  0.0015605           0.0468          0.9627    
6 (77) -0.0389332  -0.0131579  0.0022345          -0.5453          0.5856    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.2143448  -0.0131579  0.0039368           3.6259        0.000288 ***
2 (76) -0.0310609  -0.0133333  0.0024042          -0.3615        0.717692    
3 (77) -0.0441780  -0.0131579  0.0019054          -0.7106        0.477311    
4 (77) -0.0190011  -0.0131579  0.0020141          -0.1302        0.896408    
5 (77) -0.0206069  -0.0131579  0.0022503          -0.1570        0.875223    
6 (77) -0.0518814  -0.0131579  0.0031964          -0.6849        0.493389    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.1895404  -0.0131579  0.0024799           4.0704       4.694e-05 ***
2 (76) -0.0199501  -0.0133333  0.0014978          -0.1710          0.8642    
3 (77) -0.0158861  -0.0131579  0.0012052          -0.0786          0.9374    
4 (77) -0.0117500  -0.0131579  0.0012794           0.0394          0.9686    
5 (77) -0.0187799  -0.0131579  0.0014465          -0.1478          0.8825    
6 (77) -0.0295314  -0.0131579  0.0020757          -0.3594          0.7193    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.1308516  -0.0131579  0.0045347           2.1385         0.03247 *
2 (76)  0.0945194  -0.0133333  0.0027762           2.0469         0.04066 *
3 (77) -0.0244920  -0.0131579  0.0021928          -0.2420         0.80875  
4 (77) -0.0512433  -0.0131579  0.0023156          -0.7915         0.42868  
5 (77) -0.0751745  -0.0131579  0.0025802          -1.2209         0.22212  
6 (77) -0.0700093  -0.0131579  0.0036563          -0.9402         0.34712  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.0971524  -0.0131579  0.0025827           2.1706         0.02996 *
2 (76) -0.0466511  -0.0133333  0.0015617          -0.8431         0.39918  
3 (77) -0.0267697  -0.0131579  0.0012546          -0.3843         0.70076  
4 (77) -0.0227164  -0.0131579  0.0013312          -0.2620         0.79333  
5 (77) -0.0268900  -0.0131579  0.0015032          -0.3542         0.72320  
6 (77) -0.0342302  -0.0131579  0.0021547          -0.4540         0.64986  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77) -0.0597902  -0.0131579  0.0044985          -0.6953        0.486888   
2 (76) -0.0388081  -0.0133333  0.0027537          -0.4855        0.627349   
3 (77)  0.0398512  -0.0131579  0.0021754           1.1365        0.255737   
4 (77)  0.1134260  -0.0131579  0.0022973           2.6410        0.008267 **
5 (77) -0.0762542  -0.0131579  0.0025602          -1.2470        0.212398   
6 (77) -0.1055464  -0.0131579  0.0036284          -1.5338        0.125088   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Similar autocorrelation pattern and significance with possession with intent to distribute</p>
</div>
<div id="tabset-7-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  MI_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>    export_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"I"</span>, </span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(MI_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"export_cases"</span>))</span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(MI_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77) -0.0501879  -0.0131579  0.0038920          -0.5936          0.5528  
2 (76) -0.0318509  -0.0133333  0.0023763          -0.3799          0.7040  
3 (77)  0.0157234  -0.0131579  0.0018839           0.6654          0.5058  
4 (77)  0.0758895  -0.0131579  0.0019915           1.9954          0.0460 *
5 (77) -0.0086340  -0.0131579  0.0022256           0.0959          0.9236  
6 (77) -0.0545765  -0.0131579  0.0031619          -0.7366          0.4614  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.0076491  -0.0131579  0.0050189           0.2937         0.76899  
2 (76)  0.0783952  -0.0133333  0.0030775           1.6535         0.09823 .
3 (77) -0.0798739  -0.0131579  0.0024256          -1.3546         0.17553  
4 (77) -0.0182770  -0.0131579  0.0025598          -0.1012         0.91941  
5 (77) -0.0350293  -0.0131579  0.0028473          -0.4099         0.68189  
6 (77) -0.0481676  -0.0131579  0.0040288          -0.5516         0.58124  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided
1 (77)  0.0791753  -0.0131579  0.0046525           1.3537          0.1758
2 (76)  0.0042422  -0.0133333  0.0028494           0.3293          0.7420
3 (77) -0.0147440  -0.0131579  0.0022494          -0.0334          0.9733
4 (77) -0.0504912  -0.0131579  0.0023750          -0.7661          0.4436
5 (77) -0.0735313  -0.0131579  0.0026451          -1.1739          0.2404
6 (77) -0.0146220  -0.0131579  0.0037469          -0.0239          0.9809</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77) -0.0667544  -0.0131579  0.0048971          -0.7659         0.44374  
2 (76) -0.0863345  -0.0133333  0.0030016          -1.3324         0.18271  
3 (77)  0.0999080  -0.0131579  0.0023670           2.3240         0.02013 *
4 (77) -0.0671379  -0.0131579  0.0024984          -1.0800         0.28016  
5 (77) -0.0142748  -0.0131579  0.0027801          -0.0212         0.98310  
6 (77) -0.0102655  -0.0131579  0.0039350           0.0461         0.96322  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided
1 (77) -0.0710458  -0.0131579  0.0053430          -0.7919          0.4284
2 (76) -0.0029742  -0.0133333  0.0032791           0.1809          0.8564
3 (77)  0.0418536  -0.0131579  0.0025813           1.0828          0.2789
4 (77) -0.0747826  -0.0131579  0.0027232          -1.1809          0.2376
5 (77)  0.0223828  -0.0131579  0.0030261           0.6461          0.5182
6 (77) -0.0669589  -0.0131579  0.0042780          -0.8226          0.4108</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Moran's I
          estimate expectation    variance standard deviate Pr(I) two sided  
1 (77) -0.02081516 -0.01315789  0.00141145          -0.2038         0.83850  
2 (76) -0.00261891 -0.01333333  0.00083303           0.3712         0.71047  
3 (77) -0.02002237 -0.01315789  0.00069160          -0.2610         0.79407  
4 (77) -0.03192043 -0.01315789  0.00074052          -0.6895         0.49052  
5 (77) -0.02633163 -0.01315789  0.00085706          -0.4500         0.65272  
6 (77) -0.09223381 -0.01315789  0.00125380          -2.2332         0.02553 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>For most of the years, correlogram is flat and close to zero across all distances, suggests <strong>no significant spatial autocorrelation</strong> at any lag, meaning that the spatial distribution of values is <strong>random</strong>.</p>
</div>
<div id="tabset-7-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-8-tab">
<p>Remember to handle the years with no cases</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>  cases <span class="ot">=</span> conspiracy_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>)</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># checks if the year's vector has no_case = 0</span></span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(cases)<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Skipping year"</span>, year, <span class="st">"due to empty data (0 cases)"</span>))</span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>  <span class="co"># continue to next iteration</span></span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a>  MI_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb276-12"><a href="#cb276-12" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb276-13"><a href="#cb276-13" aria-hidden="true" tabindex="-1"></a>    cases,</span>
<span id="cb276-14"><a href="#cb276-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb276-15"><a href="#cb276-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"I"</span>, </span>
<span id="cb276-16"><a href="#cb276-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb276-17"><a href="#cb276-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb276-18"><a href="#cb276-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(MI_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"conspiracy_cases"</span>))</span>
<span id="cb276-19"><a href="#cb276-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(MI_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for cases 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.1215807  -0.0131579  0.0053259           1.8463         0.06485 .
2 (76)  0.0230655  -0.0133333  0.0032685           0.6367         0.52434  
3 (77) -0.1276333  -0.0131579  0.0025731          -2.2567         0.02402 *
4 (77) -0.0060479  -0.0131579  0.0027146           0.1365         0.89145  
5 (77) -0.0143282  -0.0131579  0.0030167          -0.0213         0.98300  
6 (77) -0.1098682  -0.0131579  0.0042649          -1.4809         0.13864  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for cases 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided   
1 (77)  0.2070047  -0.0131579  0.0045987           3.2466        0.001168 **
2 (76) -0.0436656  -0.0133333  0.0028160          -0.5716        0.567595   
3 (77) -0.0333358  -0.0131579  0.0022236          -0.4279        0.668717   
4 (77) -0.0206808  -0.0131579  0.0023479          -0.1553        0.876619   
5 (77) -0.0504201  -0.0131579  0.0026155          -0.7286        0.466242   
6 (77) -0.0550177  -0.0131579  0.0037055          -0.6877        0.491666   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for cases 
method: Moran's I
          estimate expectation    variance standard deviate Pr(I) two sided
1 (77)  0.01621459 -0.01315789  0.00106794           0.8988          0.3688
2 (76)  0.00978584 -0.01333333  0.00061931           0.9290          0.3529
3 (77) -0.01255721 -0.01315789  0.00052649           0.0262          0.9791
4 (77) -0.01883223 -0.01315789  0.00056728          -0.2382          0.8117
5 (77) -0.02896492 -0.01315789  0.00066755          -0.6118          0.5407
6 (77) -0.02738208 -0.01315789  0.00098956          -0.4522          0.6511</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for cases 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided  
1 (77)  0.0168143  -0.0131579  0.0046729           0.4385         0.66106  
2 (76)  0.0838190  -0.0133333  0.0028622           1.8160         0.06938 .
3 (77) -0.0582069  -0.0131579  0.0022592          -0.9478         0.34324  
4 (77) -0.0208558  -0.0131579  0.0023853          -0.1576         0.87476  
5 (77) -0.0338693  -0.0131579  0.0026564          -0.4018         0.68780  
6 (77) -0.0481529  -0.0131579  0.0037626          -0.5705         0.56833  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping year 2021 due to empty data (0 cases)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping year 2022 due to empty data (0 cases)</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Similar autocorrelation pattern and significance with possession with intent to distribute</p>
</div>
</div>
</div>
</section>
<section id="gearys-c-1" class="level3">
<h3 class="anchored" data-anchor-id="gearys-c-1">Geary’s C</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">drug use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">possession</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">possession with intent to distribute</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">trafficking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-5" role="tab" aria-controls="tabset-8-5" aria-selected="false">production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-6" role="tab" aria-controls="tabset-8-6" aria-selected="false">import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-7" role="tab" aria-controls="tabset-8-7" aria-selected="false">export</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-8" role="tab" aria-controls="tabset-8-8" aria-selected="false">conspiracy</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>  GC_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>    drug_use_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"C"</span>, </span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(GC_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"drug_use_cases"</span>))</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(GC_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 1.025845    1.000000 0.020655           0.1798          0.8573
2 (76) 1.007516    1.000000 0.015434           0.0605          0.9518
3 (77) 0.957695    1.000000 0.017516          -0.3197          0.7492
4 (77) 0.941691    1.000000 0.026950          -0.3552          0.7224
5 (77) 1.096812    1.000000 0.056515           0.4072          0.6838
6 (77) 0.992459    1.000000 0.112669          -0.0225          0.9821</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 1.003652    1.000000 0.018924           0.0265          0.9788
2 (76) 1.032794    1.000000 0.014041           0.2768          0.7820
3 (77) 0.943228    1.000000 0.015794          -0.4517          0.6515
4 (77) 0.920995    1.000000 0.024139          -0.5085          0.6111
5 (77) 1.095522    1.000000 0.050271           0.4260          0.6701
6 (77) 1.006909    1.000000 0.099991           0.0219          0.9826</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 0.9166967   1.0000000 0.0122647          -0.7522          0.4519
2 (76) 1.0306111   1.0000000 0.0086813           0.3285          0.7425
3 (77) 0.9385333   1.0000000 0.0091712          -0.6418          0.5210
4 (77) 0.9063930   1.0000000 0.0133234          -0.8110          0.4174
5 (77) 1.0746359   1.0000000 0.0262469           0.4607          0.6450
6 (77) 1.0121803   1.0000000 0.0512189           0.0538          0.9571</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 1.1399926   1.0000000 0.0106329           1.3576          0.1746
2 (76) 1.0289152   1.0000000 0.0073678           0.3369          0.7362
3 (77) 0.9905066   1.0000000 0.0075482          -0.1093          0.9130
4 (77) 1.0570936   1.0000000 0.0106732           0.5526          0.5805
5 (77) 1.0262406   1.0000000 0.0203599           0.1839          0.8541
6 (77) 1.2054465   1.0000000 0.0392674           1.0368          0.2998</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided   
1 (77) 0.7808514   1.0000000 0.0077702          -2.4861        0.012914 * 
2 (76) 0.8945700   1.0000000 0.0050636          -1.4816        0.138444   
3 (77) 1.0781699   1.0000000 0.0047010           1.1401        0.254243   
4 (77) 0.8332144   1.0000000 0.0060238          -2.1489        0.031640 * 
5 (77) 1.1066271   1.0000000 0.0100322           1.0646        0.287076   
6 (77) 1.4450022   1.0000000 0.0183006           3.2895        0.001004 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for drug_use_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided   
1 (77) 1.0366729   1.0000000 0.0073570           0.4276        0.668972   
2 (76) 1.0461574   1.0000000 0.0047310           0.6711        0.502179   
3 (77) 1.0890895   1.0000000 0.0042900           1.3602        0.173772   
4 (77) 1.0654429   1.0000000 0.0053527           0.8945        0.371059   
5 (77) 1.1431019   1.0000000 0.0085414           1.5484        0.121527   
6 (77) 1.3389397   1.0000000 0.0152739           2.7425        0.006097 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  GC_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>    possession_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"C"</span>, </span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(GC_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"possession_cases"</span>))</span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(GC_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided  
1 (77) 0.7603383   1.0000000 0.0132611          -2.0812         0.03742 *
2 (76) 0.8662146   1.0000000 0.0094833          -1.3738         0.16950  
3 (77) 0.8193554   1.0000000 0.0101622          -1.7920         0.07314 .
4 (77) 0.8402066   1.0000000 0.0149417          -1.3072         0.19113  
5 (77) 0.9030045   1.0000000 0.0298417          -0.5615         0.57447  
6 (77) 0.8588501   1.0000000 0.0585169          -0.5835         0.55956  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 0.811681    1.000000 0.015409          -1.5171          0.1292
2 (76) 0.902420    1.000000 0.011212          -0.9216          0.3568
3 (77) 0.853329    1.000000 0.012298          -1.3226          0.1860
4 (77) 0.856354    1.000000 0.018430          -1.0581          0.2900
5 (77) 0.936246    1.000000 0.037589          -0.3288          0.7423
6 (77) 0.868239    1.000000 0.074246          -0.4836          0.6287</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided   
1 (77) 0.6932033   1.0000000 0.0121255          -2.7861        0.005334 **
2 (76) 0.9142878   1.0000000 0.0085692          -0.9259        0.354490   
3 (77) 0.8628823   1.0000000 0.0090327          -1.4427        0.149098   
4 (77) 0.8724798   1.0000000 0.0130973          -1.1143        0.265166   
5 (77) 0.9476489   1.0000000 0.0257447          -0.3263        0.744217   
6 (77) 0.8866702   1.0000000 0.0501994          -0.5058        0.612984   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided  
1 (77) 0.7879428   1.0000000 0.0109546          -2.0261         0.04276 *
2 (76) 0.9204468   1.0000000 0.0076268          -0.9109         0.36233  
3 (77) 0.9784123   1.0000000 0.0078682          -0.2434         0.80772  
4 (77) 0.9720050   1.0000000 0.0111957          -0.2646         0.79133  
5 (77) 0.9995664   1.0000000 0.0215205          -0.0030         0.99764  
6 (77) 1.0162565   1.0000000 0.0416236           0.0797         0.93649  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided    
1 (77) 0.7612748   1.0000000 0.0096176          -2.4343        0.014923 *  
2 (76) 0.7511029   1.0000000 0.0065506          -3.0752        0.002103 ** 
3 (77) 0.8657770   1.0000000 0.0065384          -1.6599        0.096927 .  
4 (77) 0.6194235   1.0000000 0.0090242          -4.0062       6.169e-05 ***
5 (77) 0.8773414   1.0000000 0.0166970          -0.9492        0.342495    
6 (77) 1.3032569   1.0000000 0.0318311           1.6998        0.089178 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 1.0431955   1.0000000 0.0075762           0.4963          0.6197
2 (76) 0.9989580   1.0000000 0.0049074          -0.0149          0.9881
3 (77) 1.0822602   1.0000000 0.0045080           1.2252          0.2205
4 (77) 0.9795580   1.0000000 0.0057087          -0.2706          0.7867
5 (77) 1.0536915   1.0000000 0.0093322           0.5558          0.5784
6 (77) 1.1035071   1.0000000 0.0168794           0.7967          0.4256</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>  GC_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>    possession_with_intent_to_distribute_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"C"</span>, </span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(GC_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"possession_with_intent_to_distribute_cases"</span>))</span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(GC_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 0.977063    1.000000 0.023729          -0.1489          0.8816
2 (76) 1.067462    1.000000 0.017909           0.5041          0.6142
3 (77) 0.995481    1.000000 0.020574          -0.0315          0.9749
4 (77) 0.983634    1.000000 0.031944          -0.0916          0.9270
5 (77) 1.059173    1.000000 0.067608           0.2276          0.8200
6 (77) 0.947804    1.000000 0.135189          -0.1420          0.8871</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 0.937178    1.000000 0.019212          -0.4532          0.6504
2 (76) 1.072144    1.000000 0.014273           0.6039          0.5459
3 (77) 1.008058    1.000000 0.016081           0.0635          0.9493
4 (77) 0.980108    1.000000 0.024606          -0.1268          0.8991
5 (77) 1.043606    1.000000 0.051310           0.1925          0.8473
6 (77) 0.958147    1.000000 0.102100          -0.1310          0.8958</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 0.940253    1.000000 0.015490          -0.4801          0.6312
2 (76) 1.114501    1.000000 0.011277           1.0782          0.2809
3 (77) 1.032378    1.000000 0.012379           0.2910          0.7710
4 (77) 0.990147    1.000000 0.018561          -0.0723          0.9423
5 (77) 1.006700    1.000000 0.037882           0.0344          0.9725
6 (77) 0.951949    1.000000 0.074840          -0.1756          0.8606</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 1.0417446   1.0000000 0.0114345           0.3904          0.6963
2 (76) 0.9721116   1.0000000 0.0080131          -0.3115          0.7554
3 (77) 0.9516943   1.0000000 0.0083455          -0.5288          0.5970
4 (77) 1.0018557   1.0000000 0.0119751           0.0170          0.9865
5 (77) 1.0267890   1.0000000 0.0232519           0.1757          0.8605
6 (77) 1.0309239   1.0000000 0.0451386           0.1456          0.8843</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided   
1 (77) 0.7518440   1.0000000 0.0074246          -2.8800        0.003977 **
2 (76) 0.8756346   1.0000000 0.0047855          -1.7978        0.072211 . 
3 (77) 0.9848215   1.0000000 0.0043573          -0.2299        0.818136   
4 (77) 0.7836293   1.0000000 0.0054626          -2.9275        0.003417 **
5 (77) 1.0235045   1.0000000 0.0087855           0.2508        0.801995   
6 (77) 1.2763997   1.0000000 0.0157695           2.2010        0.027733 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for possession_with_intent_to_distribute_cases %&gt;% filter(fiscal_year ==      year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided  
1 (77) 1.0646334   1.0000000 0.0080802           0.7190         0.47212  
2 (76) 1.1600256   1.0000000 0.0053131           2.1954         0.02813 *
3 (77) 1.0396696   1.0000000 0.0050093           0.5605         0.57515  
4 (77) 1.0436376   1.0000000 0.0065273           0.5401         0.58911  
5 (77) 0.8659941   1.0000000 0.0111506          -1.2690         0.20443  
6 (77) 1.0936620   1.0000000 0.0205711           0.6530         0.51374  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>  GC_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>    trafficking_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"C"</span>, </span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(GC_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"trafficking_cases"</span>))</span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(GC_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for trafficking_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 0.9121279   1.0000000 0.0112647          -0.8279          0.4077
2 (76) 1.0134923   1.0000000 0.0078764           0.1520          0.8792
3 (77) 0.8683637   1.0000000 0.0081767          -1.4558          0.1455
4 (77) 0.9022347   1.0000000 0.0116994          -0.9039          0.3661
5 (77) 1.0946627   1.0000000 0.0226395           0.6291          0.5293
6 (77) 0.9552492   1.0000000 0.0438952          -0.2136          0.8309</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for trafficking_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 0.8823127   1.0000000 0.0082248          -1.2977          0.1944
2 (76) 0.9758939   1.0000000 0.0054295          -0.3271          0.7436
3 (77) 0.8911844   1.0000000 0.0051532          -1.5158          0.1296
4 (77) 0.9495700   1.0000000 0.0067622          -0.6133          0.5397
5 (77) 1.1313537   1.0000000 0.0116723           1.2158          0.2241
6 (77) 0.9170223   1.0000000 0.0216301          -0.5642          0.5726</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for trafficking_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided  
1 (77) 0.7765561   1.0000000 0.0123205          -2.0130         0.04411 *
2 (76) 0.8453994   1.0000000 0.0087262          -1.6550         0.09792 .
3 (77) 0.7813954   1.0000000 0.0092267          -2.2758         0.02286 *
4 (77) 0.8775559   1.0000000 0.0134141          -1.0572         0.29042  
5 (77) 1.0678267   1.0000000 0.0264484           0.4171         0.67663  
6 (77) 1.0655954   1.0000000 0.0516280           0.2887         0.77282  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for trafficking_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided  
1 (77) 0.9155115   1.0000000 0.0128276          -0.7460         0.45568  
2 (76) 0.8270832   1.0000000 0.0091344          -1.8092         0.07041 .
3 (77) 0.8220777   1.0000000 0.0097311          -1.8036         0.07129 .
4 (77) 0.7689026   1.0000000 0.0142377          -1.9368         0.05278 .
5 (77) 0.8165201   1.0000000 0.0282780          -1.0911         0.27523  
6 (77) 0.7470304   1.0000000 0.0553423          -1.0753         0.28223  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for trafficking_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided  
1 (77) 0.8283227   1.0000000 0.0128718          -1.5132         0.13023  
2 (76) 0.8886772   1.0000000 0.0091700          -1.1625         0.24503  
3 (77) 0.8619619   1.0000000 0.0097751          -1.3962         0.16266  
4 (77) 0.7763758   1.0000000 0.0143095          -1.8694         0.06156 .
5 (77) 0.9392638   1.0000000 0.0284374          -0.3602         0.71872  
6 (77) 1.2151645   1.0000000 0.0556659           0.9120         0.36179  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for trafficking_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided  
1 (77) 1.0195273   1.0000000 0.0090885           0.2048         0.83770  
2 (76) 1.1141181   1.0000000 0.0061247           1.4582         0.14479  
3 (77) 1.1090360   1.0000000 0.0060122           1.4062         0.15966  
4 (77) 0.9343341   1.0000000 0.0081649          -0.7267         0.46740  
5 (77) 0.7925758   1.0000000 0.0147882          -1.7057         0.08806 .
6 (77) 0.9682140   1.0000000 0.0279560          -0.1901         0.84923  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-8-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>  GC_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>    production_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"C"</span>, </span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(GC_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"production_cases"</span>))</span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(GC_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided    
1 (77) 0.547079    1.000000 0.016506          -3.5253       0.0004229 ***
2 (76) 0.830325    1.000000 0.012095          -1.5428       0.1228777    
3 (77) 0.749610    1.000000 0.013390          -2.1639       0.0304740 *  
4 (77) 0.587882    1.000000 0.020212          -2.8988       0.0037460 ** 
5 (77) 0.639593    1.000000 0.041549          -1.7681       0.0770384 .  
6 (77) 0.780957    1.000000 0.082284          -0.7636       0.4450994    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided    
1 (77) 0.577316    1.000000 0.016038          -3.3377       0.0008449 ***
2 (76) 0.785412    1.000000 0.011718          -1.9823       0.0474453 *  
3 (77) 0.686025    1.000000 0.012924          -2.7618       0.0057479 ** 
4 (77) 0.555840    1.000000 0.019452          -3.1847       0.0014493 ** 
5 (77) 0.631699    1.000000 0.039860          -1.8447       0.0650747 .  
6 (77) 0.778642    1.000000 0.078855          -0.7883       0.4305323    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided   
1 (77) 0.693166    1.000000 0.015933          -2.4309        0.015063 * 
2 (76) 0.826324    1.000000 0.011634          -1.6102        0.107353   
3 (77) 0.748382    1.000000 0.012819          -2.2223        0.026260 * 
4 (77) 0.604742    1.000000 0.019281          -2.8466        0.004419 **
5 (77) 0.662805    1.000000 0.039480          -1.6971        0.089687 . 
6 (77) 0.792895    1.000000 0.078083          -0.7412        0.458597   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided  
1 (77) 0.7544069   1.0000000 0.0110423          -2.3371         0.01943 *
2 (76) 0.9101698   1.0000000 0.0076974          -1.0239         0.30589  
3 (77) 0.9741034   1.0000000 0.0079555          -0.2903         0.77155  
4 (77) 0.9322100   1.0000000 0.0113382          -0.6366         0.52436  
5 (77) 1.0046266   1.0000000 0.0218372           0.0313         0.97502  
6 (77) 0.9641394   1.0000000 0.0422664          -0.1744         0.86153  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided    
1 (77) 0.5692587   1.0000000 0.0086183          -4.6399       3.486e-06 ***
2 (76) 0.8192017   1.0000000 0.0057463          -2.3851         0.01708 *  
3 (77) 0.8838705   1.0000000 0.0055445          -1.5596         0.11886    
4 (77) 0.8136249   1.0000000 0.0074013          -2.1664         0.03028 *  
5 (77) 0.9229837   1.0000000 0.0130919          -0.6731         0.50088    
6 (77) 1.3217895   1.0000000 0.0245122           2.0553         0.03985 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for production_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 0.9291860   1.0000000 0.0089123          -0.7501          0.4532
2 (76) 1.0196384   1.0000000 0.0059829           0.2539          0.7996
3 (77) 0.9297275   1.0000000 0.0058370          -0.9198          0.3577
4 (77) 0.8892738   1.0000000 0.0078788          -1.2474          0.2122
5 (77) 1.0418370   1.0000000 0.0141526           0.3517          0.7251
6 (77) 1.0584190   1.0000000 0.0266656           0.3577          0.7205</code></pre>
</div>
</div>
</div>
<div id="tabset-8-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>  GC_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>    import_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"C"</span>, </span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(GC_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"import_cases"</span>))</span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(GC_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided  
1 (77) 0.916624    1.000000 0.026648          -0.5108         0.60952  
2 (76) 1.257868    1.000000 0.020258           1.8117         0.07003 .
3 (77) 0.874629    1.000000 0.023477          -0.8182         0.41322  
4 (77) 0.741813    1.000000 0.036683          -1.3480         0.17765  
5 (77) 0.595490    1.000000 0.078137          -1.4471         0.14787  
6 (77) 0.677256    1.000000 0.156563          -0.8157         0.41469  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided  
1 (77) 0.727231    1.000000 0.018990          -1.9794         0.04777 *
2 (76) 1.088242    1.000000 0.014095           0.7433         0.45732  
3 (77) 0.956848    1.000000 0.015860          -0.3426         0.73186  
4 (77) 0.840919    1.000000 0.024246          -1.0216         0.30696  
5 (77) 0.658409    1.000000 0.050510          -1.5199         0.12854  
6 (77) 0.711559    1.000000 0.100478          -0.9100         0.36284  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided  
1 (77) 0.938956    1.000000 0.027912          -0.3654         0.71483  
2 (76) 1.292537    1.000000 0.021276           2.0055         0.04491 *
3 (77) 0.879547    1.000000 0.024734          -0.7659         0.44374  
4 (77) 0.736212    1.000000 0.038737          -1.3403         0.18016  
5 (77) 0.591165    1.000000 0.082700          -1.4217         0.15512  
6 (77) 0.668998    1.000000 0.165827          -0.8128         0.41631  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 1.075297    1.000000 0.015328           0.6082          0.5431
2 (76) 1.051441    1.000000 0.011147           0.4872          0.6261
3 (77) 1.036754    1.000000 0.012218           0.3325          0.7395
4 (77) 1.046771    1.000000 0.018299           0.3458          0.7295
5 (77) 0.959159    1.000000 0.037300          -0.2115          0.8325
6 (77) 0.936544    1.000000 0.073659          -0.2338          0.8151</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided  
1 (77) 1.081196    1.000000 0.027283           0.4916         0.62302  
2 (76) 1.309788    1.000000 0.020770           2.1496         0.03159 *
3 (77) 0.885670    1.000000 0.024109          -0.7363         0.46153  
4 (77) 0.754552    1.000000 0.037715          -1.2639         0.20628  
5 (77) 0.662688    1.000000 0.080429          -1.1894         0.23429  
6 (77) 0.752906    1.000000 0.161217          -0.6154         0.53829  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for import_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided  
1 (77) 1.093830    1.000000 0.015550           0.7524         0.45178  
2 (76) 0.963555    1.000000 0.011326          -0.3425         0.73201  
3 (77) 1.024622    1.000000 0.012439           0.2208         0.82528  
4 (77) 0.967850    1.000000 0.018660          -0.2354         0.81393  
5 (77) 1.226193    1.000000 0.038100           1.1588         0.24653  
6 (77) 1.648729    1.000000 0.075283           2.3644         0.01806 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-8-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a>  GC_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb325-5"><a href="#cb325-5" aria-hidden="true" tabindex="-1"></a>    export_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb325-6"><a href="#cb325-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb325-7"><a href="#cb325-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"C"</span>, </span>
<span id="cb325-8"><a href="#cb325-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb325-9"><a href="#cb325-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb325-10"><a href="#cb325-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(GC_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"export_cases"</span>))</span>
<span id="cb325-11"><a href="#cb325-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(GC_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided   
1 (77) 1.059393    1.000000 0.019265           0.4279          0.6687   
2 (76) 0.960370    1.000000 0.014316          -0.3312          0.7405   
3 (77) 1.021797    1.000000 0.016133           0.1716          0.8637   
4 (77) 0.978973    1.000000 0.024692          -0.1338          0.8936   
5 (77) 0.973676    1.000000 0.051500          -0.1160          0.9077   
6 (77) 1.946839    1.000000 0.102487           2.9576          0.0031 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 0.9382775   1.0000000 0.0123631          -0.5551          0.5788
2 (76) 1.0007909   1.0000000 0.0087605           0.0084          0.9933
3 (77) 1.0236243   1.0000000 0.0092691           0.2454          0.8062
4 (77) 0.9199682   1.0000000 0.0134833          -0.6892          0.4907
5 (77) 0.9497646   1.0000000 0.0266022          -0.3080          0.7581
6 (77) 0.8831825   1.0000000 0.0519402          -0.5126          0.6082</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided    
1 (77) 0.667707    1.000000 0.014607          -2.7494        0.005971 ** 
2 (76) 0.590160    1.000000 0.010567          -3.9869       6.694e-05 ***
3 (77) 0.791347    1.000000 0.011501          -1.9456        0.051705 .  
4 (77) 0.805151    1.000000 0.017128          -1.4888        0.136537    
5 (77) 0.930226    1.000000 0.034699          -0.3746        0.707980    
6 (77) 0.964470    1.000000 0.068378          -0.1359        0.891920    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 1.0626253   1.0000000 0.0131094           0.5470          0.5844
2 (76) 1.0194888   1.0000000 0.0093612           0.2014          0.8404
3 (77) 0.8977201   1.0000000 0.0100113          -1.0222          0.3067
4 (77) 1.0221411   1.0000000 0.0146953           0.1826          0.8551
5 (77) 0.9263348   1.0000000 0.0292944          -0.4304          0.6669
6 (77) 0.8262667   1.0000000 0.0574057          -0.7251          0.4684</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 0.9808435   1.0000000 0.0103786          -0.1880          0.8508
2 (76) 1.0003824   1.0000000 0.0071631           0.0045          0.9964
3 (77) 0.8762922   1.0000000 0.0072953          -1.4484          0.1475
4 (77) 0.9750185   1.0000000 0.0102602          -0.2466          0.8052
5 (77) 0.8527969   1.0000000 0.0194425          -1.0557          0.2911
6 (77) 0.9438121   1.0000000 0.0374049          -0.2905          0.7714</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for export_cases %&gt;% filter(fiscal_year == year) %&gt;% dplyr::pull(2) 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided   
1 (77) 1.098305    1.000000 0.034456           0.5296        0.596392   
2 (76) 0.886452    1.000000 0.026543          -0.6970        0.485832   
3 (77) 1.154979    1.000000 0.031243           0.8768        0.380596   
4 (77) 1.292731    1.000000 0.049365           1.3175        0.187661   
5 (77) 1.459443    1.000000 0.106306           1.4091        0.158796   
6 (77) 2.192125    1.000000 0.213752           2.5785        0.009923 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-8-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-8-tab">
<p>Remember to handle the years with no cases</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>  cases <span class="ot">=</span> conspiracy_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>)</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># checks if the year's vector has no_case = 0</span></span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(cases)<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Skipping year"</span>, year, <span class="st">"due to empty data (0 cases)"</span>))</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>  <span class="co"># continue to next iteration</span></span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>  GC_corr <span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(</span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>    nb,</span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a>    cases,</span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"C"</span>, </span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="st">"W"</span>,</span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) <span class="co"># handle Phuket, an isolated province</span></span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(GC_corr, <span class="at">main =</span> <span class="fu">paste</span>(year, <span class="st">"conspiracy_cases"</span>))</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(GC_corr)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for cases 
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (77) 0.9139050   1.0000000 0.0104830          -0.8409          0.4004
2 (76) 0.9221307   1.0000000 0.0072472          -0.9147          0.3603
3 (77) 1.1159238   1.0000000 0.0073991           1.3477          0.1778
4 (77) 0.8985914   1.0000000 0.0104298          -0.9930          0.3207
5 (77) 0.9031464   1.0000000 0.0198192          -0.6880          0.4915
6 (77) 1.1275210   1.0000000 0.0381696           0.6527          0.5139</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for cases 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 0.851959    1.000000 0.014937          -1.2113          0.2258
2 (76) 1.121384    1.000000 0.010832           1.1663          0.2435
3 (77) 1.042988    1.000000 0.011829           0.3953          0.6927
4 (77) 1.031040    1.000000 0.017663           0.2336          0.8153
5 (77) 0.974864    1.000000 0.035887          -0.1327          0.8944
6 (77) 0.882162    1.000000 0.070790          -0.4429          0.6578</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for cases 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided
1 (77) 1.164386    1.000000 0.036560           0.8597          0.3899
2 (76) 1.089671    1.000000 0.028237           0.5336          0.5936
3 (77) 0.951268    1.000000 0.033335          -0.2669          0.7895
4 (77) 1.000735    1.000000 0.052781           0.0032          0.9974
5 (77) 1.071845    1.000000 0.113896           0.2129          0.8314
6 (77) 0.936610    1.000000 0.229160          -0.1324          0.8947</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for cases 
method: Geary's C
       estimate expectation variance standard deviate Pr(I) two sided  
1 (77) 1.246554    1.000000 0.014482           2.0488         0.04048 *
2 (76) 1.004436    1.000000 0.010466           0.0434         0.96542  
3 (77) 1.075149    1.000000 0.011377           0.7046         0.48109  
4 (77) 0.996022    1.000000 0.016925          -0.0306         0.97561  
5 (77) 0.928111    1.000000 0.034248          -0.3885         0.69768  
6 (77) 0.979559    1.000000 0.067461          -0.0787         0.93727  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping year 2021 due to empty data (0 cases)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping year 2022 due to empty data (0 cases)</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="local-indicators-of-spatial-association-lisa" class="level1">
<h1>Local Indicators of Spatial Association (LISA)</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">drug use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">possession</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">possession with intent to distribute</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">trafficking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-6" role="tab" aria-controls="tabset-9-6" aria-selected="false">import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-7" role="tab" aria-controls="tabset-9-7" aria-selected="false">export</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-8" role="tab" aria-controls="tabset-9-8" aria-selected="false">conspiracy</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>  lisa <span class="ot">&lt;-</span> wm_q <span class="sc">%&gt;%</span> </span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>      drug_use_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>), </span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>nb, </span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>wt, </span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_moran)</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a>  map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"ii"</span>) <span class="sc">+</span> </span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"local Moran's I of no_cases for"</span>, year),</span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_ii"</span>,</span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb341-26"><a href="#cb341-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb341-27"><a href="#cb341-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of local Moran's I for"</span>, year),</span>
<span id="cb341-28"><a href="#cb341-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb341-29"><a href="#cb341-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-30"><a href="#cb341-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-31"><a href="#cb341-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-32"><a href="#cb341-32" aria-hidden="true" tabindex="-1"></a>  lisa_sig <span class="ot">&lt;-</span> lisa  <span class="sc">%&gt;%</span></span>
<span id="cb341-33"><a href="#cb341-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb341-34"><a href="#cb341-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-35"><a href="#cb341-35" aria-hidden="true" tabindex="-1"></a>  map_lisa <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb341-36"><a href="#cb341-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb341-37"><a href="#cb341-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb341-38"><a href="#cb341-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-39"><a href="#cb341-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(lisa_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb341-40"><a href="#cb341-40" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span>  map_lisa <span class="sc">+</span></span>
<span id="cb341-41"><a href="#cb341-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb341-42"><a href="#cb341-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb341-43"><a href="#cb341-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb341-44"><a href="#cb341-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Clusters for"</span>, year),</span>
<span id="cb341-45"><a href="#cb341-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb341-46"><a href="#cb341-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb341-47"><a href="#cb341-47" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span> map_lisa <span class="sc">+</span></span>
<span id="cb341-48"><a href="#cb341-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"No Significant LISA Clusters for"</span>, year),</span>
<span id="cb341-49"><a href="#cb341-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb341-50"><a href="#cb341-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb341-51"><a href="#cb341-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-52"><a href="#cb341-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-53"><a href="#cb341-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map1, map2, map_lisa, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb341-54"><a href="#cb341-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-55"><a href="#cb341-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-103-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-103-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-103-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-103-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-103-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Growing Clusters</strong>: At first from 2017 to 2019, significant hotspots were mostly in the Bangkok region; going to 2022, there is a clear increase in the number of significant hotspots in northern regions over time, particularly in 2020 and 2021. This suggests a spread or increase in drug use in those areas, which might indicate a need for more intervention or preventive measures.</p></li>
<li><p><strong>Emerging Hotspots in Southern Provinces</strong>: From 2020 onwards, the southern provinces show emerging high-high clusters, indicating a recent increase in drug use cases.</p></li>
<li><p><strong>Shifting Patterns</strong>: Some areas shift from being coldspots to neutral or even to hotspots, showing that drug use is dynamic across the country, e.g.&nbsp;northwestern region of Thailand from 2018 to 2020</p></li>
</ul>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>  lisa <span class="ot">&lt;-</span> wm_q <span class="sc">%&gt;%</span> </span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a>      possession_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>), </span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>nb, </span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>wt, </span>
<span id="cb342-8"><a href="#cb342-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb342-9"><a href="#cb342-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_moran)</span>
<span id="cb342-10"><a href="#cb342-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-11"><a href="#cb342-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-12"><a href="#cb342-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-13"><a href="#cb342-13" aria-hidden="true" tabindex="-1"></a>  map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb342-14"><a href="#cb342-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"ii"</span>) <span class="sc">+</span> </span>
<span id="cb342-15"><a href="#cb342-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb342-16"><a href="#cb342-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb342-17"><a href="#cb342-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"local Moran's I of no_cases for"</span>, year),</span>
<span id="cb342-18"><a href="#cb342-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb342-19"><a href="#cb342-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-20"><a href="#cb342-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-21"><a href="#cb342-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-22"><a href="#cb342-22" aria-hidden="true" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb342-23"><a href="#cb342-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_ii"</span>,</span>
<span id="cb342-24"><a href="#cb342-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb342-25"><a href="#cb342-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb342-26"><a href="#cb342-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb342-27"><a href="#cb342-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of local Moran's I for"</span>, year),</span>
<span id="cb342-28"><a href="#cb342-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb342-29"><a href="#cb342-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-30"><a href="#cb342-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-31"><a href="#cb342-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-32"><a href="#cb342-32" aria-hidden="true" tabindex="-1"></a>  lisa_sig <span class="ot">&lt;-</span> lisa  <span class="sc">%&gt;%</span></span>
<span id="cb342-33"><a href="#cb342-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb342-34"><a href="#cb342-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-35"><a href="#cb342-35" aria-hidden="true" tabindex="-1"></a>  map_lisa <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb342-36"><a href="#cb342-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb342-37"><a href="#cb342-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb342-38"><a href="#cb342-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-39"><a href="#cb342-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(lisa_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb342-40"><a href="#cb342-40" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span>  map_lisa <span class="sc">+</span></span>
<span id="cb342-41"><a href="#cb342-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb342-42"><a href="#cb342-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb342-43"><a href="#cb342-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb342-44"><a href="#cb342-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Clusters for"</span>, year),</span>
<span id="cb342-45"><a href="#cb342-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb342-46"><a href="#cb342-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb342-47"><a href="#cb342-47" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span> map_lisa <span class="sc">+</span></span>
<span id="cb342-48"><a href="#cb342-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"No Significant LISA Clusters for"</span>, year),</span>
<span id="cb342-49"><a href="#cb342-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb342-50"><a href="#cb342-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb342-51"><a href="#cb342-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-52"><a href="#cb342-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-53"><a href="#cb342-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map1, map2, map_lisa, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb342-54"><a href="#cb342-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-55"><a href="#cb342-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-104-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-104-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-104-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-104-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-104-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Significant Southern Clustering</strong>: The southern region consistently shows significant <strong>High-High clusters</strong>, indicating concentrated areas of high drug possession rates.</p></li>
<li><p><strong>Northern Clusters</strong>: The northern areas display <strong>Low-Low clusters</strong> over the years, representing regions with persistently low drug possession cases, except for a sudden clustering in 2020</p></li>
<li><p><strong>Strong Spatial Autocorrelation</strong>: Most regions exhibit statistically significant clustering, especially in the south, suggesting non-random patterns in drug possession cases.</p></li>
<li><p><strong>Temporal Decline</strong>: From 2020 onwards, fewer regions show strong clustering, indicating a potential <strong>decline in spatial concentration</strong> of drug possession cases.</p></li>
<li><p><strong>Shifts in Patterns</strong>: While southern hot spots remain dominant, new clusters occasionally emerge, reflecting dynamic changes in drug possession trends across the country.</p></li>
</ul>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>  lisa <span class="ot">&lt;-</span> wm_q <span class="sc">%&gt;%</span> </span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>      possession_with_intent_to_distribute_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>), </span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>nb, </span>
<span id="cb343-7"><a href="#cb343-7" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>wt, </span>
<span id="cb343-8"><a href="#cb343-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb343-9"><a href="#cb343-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_moran)</span>
<span id="cb343-10"><a href="#cb343-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-11"><a href="#cb343-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-12"><a href="#cb343-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-13"><a href="#cb343-13" aria-hidden="true" tabindex="-1"></a>  map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb343-14"><a href="#cb343-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"ii"</span>) <span class="sc">+</span> </span>
<span id="cb343-15"><a href="#cb343-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb343-16"><a href="#cb343-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb343-17"><a href="#cb343-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"local Moran's I of no_cases for"</span>, year),</span>
<span id="cb343-18"><a href="#cb343-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb343-19"><a href="#cb343-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-20"><a href="#cb343-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-21"><a href="#cb343-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-22"><a href="#cb343-22" aria-hidden="true" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb343-23"><a href="#cb343-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_ii"</span>,</span>
<span id="cb343-24"><a href="#cb343-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb343-25"><a href="#cb343-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb343-26"><a href="#cb343-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb343-27"><a href="#cb343-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of local Moran's I for"</span>, year),</span>
<span id="cb343-28"><a href="#cb343-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb343-29"><a href="#cb343-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-30"><a href="#cb343-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-31"><a href="#cb343-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-32"><a href="#cb343-32" aria-hidden="true" tabindex="-1"></a>  lisa_sig <span class="ot">&lt;-</span> lisa  <span class="sc">%&gt;%</span></span>
<span id="cb343-33"><a href="#cb343-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb343-34"><a href="#cb343-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-35"><a href="#cb343-35" aria-hidden="true" tabindex="-1"></a>  map_lisa <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb343-36"><a href="#cb343-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb343-37"><a href="#cb343-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb343-38"><a href="#cb343-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-39"><a href="#cb343-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(lisa_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb343-40"><a href="#cb343-40" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span>  map_lisa <span class="sc">+</span></span>
<span id="cb343-41"><a href="#cb343-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb343-42"><a href="#cb343-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb343-43"><a href="#cb343-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb343-44"><a href="#cb343-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Clusters for"</span>, year),</span>
<span id="cb343-45"><a href="#cb343-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb343-46"><a href="#cb343-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb343-47"><a href="#cb343-47" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span> map_lisa <span class="sc">+</span></span>
<span id="cb343-48"><a href="#cb343-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"No Significant LISA Clusters for"</span>, year),</span>
<span id="cb343-49"><a href="#cb343-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb343-50"><a href="#cb343-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb343-51"><a href="#cb343-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-52"><a href="#cb343-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-53"><a href="#cb343-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map1, map2, map_lisa, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb343-54"><a href="#cb343-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb343-55"><a href="#cb343-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-105-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-105-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-105-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-105-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-105-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Similar to possession cases, even following similar spatial positioning across each corresponding years, except:</p>
<ul>
<li>there is <strong>no significant clustering down</strong> at the southern tail region</li>
</ul>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>  lisa <span class="ot">&lt;-</span> wm_q <span class="sc">%&gt;%</span> </span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>      trafficking_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>), </span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>nb, </span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>wt, </span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-9"><a href="#cb344-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_moran)</span>
<span id="cb344-10"><a href="#cb344-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-11"><a href="#cb344-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-12"><a href="#cb344-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-13"><a href="#cb344-13" aria-hidden="true" tabindex="-1"></a>  map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb344-14"><a href="#cb344-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"ii"</span>) <span class="sc">+</span> </span>
<span id="cb344-15"><a href="#cb344-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb344-16"><a href="#cb344-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb344-17"><a href="#cb344-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"local Moran's I of no_cases for"</span>, year),</span>
<span id="cb344-18"><a href="#cb344-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb344-19"><a href="#cb344-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-20"><a href="#cb344-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-21"><a href="#cb344-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-22"><a href="#cb344-22" aria-hidden="true" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb344-23"><a href="#cb344-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_ii"</span>,</span>
<span id="cb344-24"><a href="#cb344-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb344-25"><a href="#cb344-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb344-26"><a href="#cb344-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb344-27"><a href="#cb344-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of local Moran's I for"</span>, year),</span>
<span id="cb344-28"><a href="#cb344-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb344-29"><a href="#cb344-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-30"><a href="#cb344-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-31"><a href="#cb344-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-32"><a href="#cb344-32" aria-hidden="true" tabindex="-1"></a>  lisa_sig <span class="ot">&lt;-</span> lisa  <span class="sc">%&gt;%</span></span>
<span id="cb344-33"><a href="#cb344-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb344-34"><a href="#cb344-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-35"><a href="#cb344-35" aria-hidden="true" tabindex="-1"></a>  map_lisa <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb344-36"><a href="#cb344-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb344-37"><a href="#cb344-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb344-38"><a href="#cb344-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-39"><a href="#cb344-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(lisa_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb344-40"><a href="#cb344-40" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span>  map_lisa <span class="sc">+</span></span>
<span id="cb344-41"><a href="#cb344-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb344-42"><a href="#cb344-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb344-43"><a href="#cb344-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb344-44"><a href="#cb344-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Clusters for"</span>, year),</span>
<span id="cb344-45"><a href="#cb344-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb344-46"><a href="#cb344-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb344-47"><a href="#cb344-47" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span> map_lisa <span class="sc">+</span></span>
<span id="cb344-48"><a href="#cb344-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"No Significant LISA Clusters for"</span>, year),</span>
<span id="cb344-49"><a href="#cb344-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb344-50"><a href="#cb344-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-51"><a href="#cb344-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-52"><a href="#cb344-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-53"><a href="#cb344-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map1, map2, map_lisa, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb344-54"><a href="#cb344-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-55"><a href="#cb344-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-106-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-106-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-106-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-106-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-106-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Similar to drug_use cases except:</p>
<ul>
<li>more significant High-High appeared in the <strong>central</strong> regions and one down south, with the initial clustering trends in the Bangkok region, previously present between 2017 and 2019, vanished after that period, implying a possible spread or progression of trafficking operations towards adjacent borders, may also be servicing import/export operations</li>
</ul>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>  lisa <span class="ot">&lt;-</span> wm_q <span class="sc">%&gt;%</span> </span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>      production_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>), </span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>nb, </span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>wt, </span>
<span id="cb345-8"><a href="#cb345-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb345-9"><a href="#cb345-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_moran)</span>
<span id="cb345-10"><a href="#cb345-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-11"><a href="#cb345-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-12"><a href="#cb345-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-13"><a href="#cb345-13" aria-hidden="true" tabindex="-1"></a>  map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb345-14"><a href="#cb345-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"ii"</span>) <span class="sc">+</span> </span>
<span id="cb345-15"><a href="#cb345-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb345-16"><a href="#cb345-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb345-17"><a href="#cb345-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"local Moran's I of no_cases for"</span>, year),</span>
<span id="cb345-18"><a href="#cb345-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb345-19"><a href="#cb345-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-20"><a href="#cb345-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-21"><a href="#cb345-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-22"><a href="#cb345-22" aria-hidden="true" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb345-23"><a href="#cb345-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_ii"</span>,</span>
<span id="cb345-24"><a href="#cb345-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb345-25"><a href="#cb345-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb345-26"><a href="#cb345-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb345-27"><a href="#cb345-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of local Moran's I for"</span>, year),</span>
<span id="cb345-28"><a href="#cb345-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb345-29"><a href="#cb345-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-30"><a href="#cb345-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-31"><a href="#cb345-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-32"><a href="#cb345-32" aria-hidden="true" tabindex="-1"></a>  lisa_sig <span class="ot">&lt;-</span> lisa  <span class="sc">%&gt;%</span></span>
<span id="cb345-33"><a href="#cb345-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb345-34"><a href="#cb345-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-35"><a href="#cb345-35" aria-hidden="true" tabindex="-1"></a>  map_lisa <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb345-36"><a href="#cb345-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb345-37"><a href="#cb345-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb345-38"><a href="#cb345-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-39"><a href="#cb345-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(lisa_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb345-40"><a href="#cb345-40" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span>  map_lisa <span class="sc">+</span></span>
<span id="cb345-41"><a href="#cb345-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb345-42"><a href="#cb345-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb345-43"><a href="#cb345-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb345-44"><a href="#cb345-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Clusters for"</span>, year),</span>
<span id="cb345-45"><a href="#cb345-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb345-46"><a href="#cb345-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb345-47"><a href="#cb345-47" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span> map_lisa <span class="sc">+</span></span>
<span id="cb345-48"><a href="#cb345-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"No Significant LISA Clusters for"</span>, year),</span>
<span id="cb345-49"><a href="#cb345-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb345-50"><a href="#cb345-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb345-51"><a href="#cb345-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-52"><a href="#cb345-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-53"><a href="#cb345-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map1, map2, map_lisa, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb345-54"><a href="#cb345-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-55"><a href="#cb345-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-107-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-107-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-107-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-107-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-107-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Similar clustering patterns with the drug abuse layers: distribution drug production operations are likely correlated to or could even be the cause of the spatio-temporal pattern of drug abuse cases.</p>
</div>
<div id="tabset-9-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>  lisa <span class="ot">&lt;-</span> wm_q <span class="sc">%&gt;%</span> </span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>      import_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>), </span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>nb, </span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>wt, </span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_moran)</span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a>  map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb346-14"><a href="#cb346-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"ii"</span>) <span class="sc">+</span> </span>
<span id="cb346-15"><a href="#cb346-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb346-16"><a href="#cb346-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb346-17"><a href="#cb346-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"local Moran's I of no_cases for"</span>, year),</span>
<span id="cb346-18"><a href="#cb346-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb346-19"><a href="#cb346-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-20"><a href="#cb346-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-21"><a href="#cb346-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-22"><a href="#cb346-22" aria-hidden="true" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb346-23"><a href="#cb346-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_ii"</span>,</span>
<span id="cb346-24"><a href="#cb346-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb346-25"><a href="#cb346-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb346-26"><a href="#cb346-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb346-27"><a href="#cb346-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of local Moran's I for"</span>, year),</span>
<span id="cb346-28"><a href="#cb346-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb346-29"><a href="#cb346-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-30"><a href="#cb346-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-31"><a href="#cb346-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-32"><a href="#cb346-32" aria-hidden="true" tabindex="-1"></a>  lisa_sig <span class="ot">&lt;-</span> lisa  <span class="sc">%&gt;%</span></span>
<span id="cb346-33"><a href="#cb346-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb346-34"><a href="#cb346-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-35"><a href="#cb346-35" aria-hidden="true" tabindex="-1"></a>  map_lisa <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb346-36"><a href="#cb346-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb346-37"><a href="#cb346-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb346-38"><a href="#cb346-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-39"><a href="#cb346-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(lisa_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb346-40"><a href="#cb346-40" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span>  map_lisa <span class="sc">+</span></span>
<span id="cb346-41"><a href="#cb346-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb346-42"><a href="#cb346-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb346-43"><a href="#cb346-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb346-44"><a href="#cb346-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Clusters for"</span>, year),</span>
<span id="cb346-45"><a href="#cb346-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb346-46"><a href="#cb346-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb346-47"><a href="#cb346-47" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span> map_lisa <span class="sc">+</span></span>
<span id="cb346-48"><a href="#cb346-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"No Significant LISA Clusters for"</span>, year),</span>
<span id="cb346-49"><a href="#cb346-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb346-50"><a href="#cb346-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb346-51"><a href="#cb346-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-52"><a href="#cb346-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-53"><a href="#cb346-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map1, map2, map_lisa, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb346-54"><a href="#cb346-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-55"><a href="#cb346-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-108-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-108-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-108-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-108-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-108-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>  lisa <span class="ot">&lt;-</span> wm_q <span class="sc">%&gt;%</span> </span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>      export_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>), </span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>nb, </span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>wt, </span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_moran)</span>
<span id="cb347-10"><a href="#cb347-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-11"><a href="#cb347-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-12"><a href="#cb347-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-13"><a href="#cb347-13" aria-hidden="true" tabindex="-1"></a>  map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb347-14"><a href="#cb347-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"ii"</span>) <span class="sc">+</span> </span>
<span id="cb347-15"><a href="#cb347-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb347-16"><a href="#cb347-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb347-17"><a href="#cb347-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"local Moran's I of no_cases for"</span>, year),</span>
<span id="cb347-18"><a href="#cb347-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb347-19"><a href="#cb347-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-20"><a href="#cb347-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-21"><a href="#cb347-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-22"><a href="#cb347-22" aria-hidden="true" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb347-23"><a href="#cb347-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_ii"</span>,</span>
<span id="cb347-24"><a href="#cb347-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb347-25"><a href="#cb347-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb347-26"><a href="#cb347-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb347-27"><a href="#cb347-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of local Moran's I for"</span>, year),</span>
<span id="cb347-28"><a href="#cb347-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb347-29"><a href="#cb347-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-30"><a href="#cb347-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-31"><a href="#cb347-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-32"><a href="#cb347-32" aria-hidden="true" tabindex="-1"></a>  lisa_sig <span class="ot">&lt;-</span> lisa  <span class="sc">%&gt;%</span></span>
<span id="cb347-33"><a href="#cb347-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb347-34"><a href="#cb347-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-35"><a href="#cb347-35" aria-hidden="true" tabindex="-1"></a>  map_lisa <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb347-36"><a href="#cb347-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb347-37"><a href="#cb347-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb347-38"><a href="#cb347-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-39"><a href="#cb347-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(lisa_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb347-40"><a href="#cb347-40" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span>  map_lisa <span class="sc">+</span></span>
<span id="cb347-41"><a href="#cb347-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb347-42"><a href="#cb347-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb347-43"><a href="#cb347-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb347-44"><a href="#cb347-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Clusters for"</span>, year),</span>
<span id="cb347-45"><a href="#cb347-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb347-46"><a href="#cb347-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb347-47"><a href="#cb347-47" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span> map_lisa <span class="sc">+</span></span>
<span id="cb347-48"><a href="#cb347-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"No Significant LISA Clusters for"</span>, year),</span>
<span id="cb347-49"><a href="#cb347-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb347-50"><a href="#cb347-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb347-51"><a href="#cb347-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-52"><a href="#cb347-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-53"><a href="#cb347-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map1, map2, map_lisa, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb347-54"><a href="#cb347-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-55"><a href="#cb347-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-109-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-109-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-109-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-109-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-109-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-8-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> yr){</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (year<span class="sc">==</span><span class="dv">2021</span> <span class="sc">|</span> year<span class="sc">==</span><span class="dv">2022</span>){<span class="cf">next</span>} <span class="co"># force to skip years with no cases</span></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a>  lisa <span class="ot">&lt;-</span> wm_q <span class="sc">%&gt;%</span> </span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a>      conspiracy_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>), </span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>nb, </span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a>      wm_q<span class="sc">$</span>wt, </span>
<span id="cb348-11"><a href="#cb348-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb348-12"><a href="#cb348-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_moran)</span>
<span id="cb348-13"><a href="#cb348-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-14"><a href="#cb348-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-15"><a href="#cb348-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-16"><a href="#cb348-16" aria-hidden="true" tabindex="-1"></a>  map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb348-17"><a href="#cb348-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"ii"</span>) <span class="sc">+</span> </span>
<span id="cb348-18"><a href="#cb348-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb348-19"><a href="#cb348-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb348-20"><a href="#cb348-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"local Moran's I of no_cases for"</span>, year),</span>
<span id="cb348-21"><a href="#cb348-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb348-22"><a href="#cb348-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-23"><a href="#cb348-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-24"><a href="#cb348-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-25"><a href="#cb348-25" aria-hidden="true" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb348-26"><a href="#cb348-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_ii"</span>,</span>
<span id="cb348-27"><a href="#cb348-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb348-28"><a href="#cb348-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span> </span>
<span id="cb348-29"><a href="#cb348-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb348-30"><a href="#cb348-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of local Moran's I for"</span>, year),</span>
<span id="cb348-31"><a href="#cb348-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb348-32"><a href="#cb348-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-33"><a href="#cb348-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-34"><a href="#cb348-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-35"><a href="#cb348-35" aria-hidden="true" tabindex="-1"></a>  lisa_sig <span class="ot">&lt;-</span> lisa  <span class="sc">%&gt;%</span></span>
<span id="cb348-36"><a href="#cb348-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb348-37"><a href="#cb348-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-38"><a href="#cb348-38" aria-hidden="true" tabindex="-1"></a>  map_lisa <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb348-39"><a href="#cb348-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb348-40"><a href="#cb348-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb348-41"><a href="#cb348-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-42"><a href="#cb348-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(lisa_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb348-43"><a href="#cb348-43" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span>  map_lisa <span class="sc">+</span></span>
<span id="cb348-44"><a href="#cb348-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb348-45"><a href="#cb348-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb348-46"><a href="#cb348-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb348-47"><a href="#cb348-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Clusters for"</span>, year),</span>
<span id="cb348-48"><a href="#cb348-48" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb348-49"><a href="#cb348-49" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb348-50"><a href="#cb348-50" aria-hidden="true" tabindex="-1"></a>    map_lisa <span class="ot">&lt;-</span> map_lisa <span class="sc">+</span></span>
<span id="cb348-51"><a href="#cb348-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"No Significant LISA Clusters for"</span>, year),</span>
<span id="cb348-52"><a href="#cb348-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb348-53"><a href="#cb348-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb348-54"><a href="#cb348-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-55"><a href="#cb348-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-56"><a href="#cb348-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map1, map2, map_lisa, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb348-57"><a href="#cb348-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb348-58"><a href="#cb348-58" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-110-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-110-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-110-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="hot-spot-and-cold-spot-area-analysis-getis-and-ords-g-statistics" class="level1">
<h1>Hot Spot and Cold Spot Area Analysis (Getis and Ord’s G-Statistics)</h1>
<p>Compute Inverse Distance Weights</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co"># derive a spatial weight matrix</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>wm_idw <span class="ot">&lt;-</span> wm_data <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="dv">32647</span>) <span class="sc">%&gt;%</span>  <span class="co"># UTM Zone 47N for Thailand</span></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">nb =</span> <span class="fu">include_self</span>(<span class="fu">st_contiguity</span>(geometry)),</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">wts =</span> <span class="fu">st_inverse_distance</span>(nb, geometry, <span class="at">scale =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Polygon provided. Using point on surface.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">drug use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">possession</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">possession with intent to distribute</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">trafficking</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-5" role="tab" aria-controls="tabset-10-5" aria-selected="false">production</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-6" role="tab" aria-controls="tabset-10-6" aria-selected="false">import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-7" role="tab" aria-controls="tabset-10-7" aria-selected="false">export</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-8" role="tab" aria-controls="tabset-10-8" aria-selected="false">conspiracy</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> yr){</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>  HCSA <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span></span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a>      drug_use_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>nb,</span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>wts,</span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-13"><a href="#cb353-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(HCSA)</span></span>
<span id="cb353-14"><a href="#cb353-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-15"><a href="#cb353-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb353-16"><a href="#cb353-16" aria-hidden="true" tabindex="-1"></a>  map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb353-17"><a href="#cb353-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span></span>
<span id="cb353-18"><a href="#cb353-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb353-19"><a href="#cb353-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb353-20"><a href="#cb353-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of no_cases for"</span>, year),</span>
<span id="cb353-21"><a href="#cb353-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb353-22"><a href="#cb353-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-23"><a href="#cb353-23" aria-hidden="true" tabindex="-1"></a>  map4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb353-24"><a href="#cb353-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb353-25"><a href="#cb353-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb353-26"><a href="#cb353-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span></span>
<span id="cb353-27"><a href="#cb353-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb353-28"><a href="#cb353-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of Gi* for"</span>, year),</span>
<span id="cb353-29"><a href="#cb353-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb353-30"><a href="#cb353-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-31"><a href="#cb353-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb353-32"><a href="#cb353-32" aria-hidden="true" tabindex="-1"></a>  HCSA_sig <span class="ot">&lt;-</span> HCSA  <span class="sc">%&gt;%</span></span>
<span id="cb353-33"><a href="#cb353-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb353-34"><a href="#cb353-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-35"><a href="#cb353-35" aria-hidden="true" tabindex="-1"></a>  map5 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb353-36"><a href="#cb353-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb353-37"><a href="#cb353-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb353-38"><a href="#cb353-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-39"><a href="#cb353-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(HCSA_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb353-40"><a href="#cb353-40" aria-hidden="true" tabindex="-1"></a>    map5 <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb353-41"><a href="#cb353-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(HCSA_sig) <span class="sc">+</span></span>
<span id="cb353-42"><a href="#cb353-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"cluster"</span>) <span class="sc">+</span></span>
<span id="cb353-43"><a href="#cb353-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb353-44"><a href="#cb353-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Map for"</span>, year), </span>
<span id="cb353-45"><a href="#cb353-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb353-46"><a href="#cb353-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb353-47"><a href="#cb353-47" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"No significant clusters found for"</span>, year)) }</span>
<span id="cb353-48"><a href="#cb353-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-49"><a href="#cb353-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map3, map4, map5, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb353-50"><a href="#cb353-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb353-51"><a href="#cb353-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-113-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-113-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-113-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-113-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-113-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Stable temporal pattern of the Bangkok region’s hot and cold spots from 2017 to 2019</p></li>
<li><p>Disperse clustering of hot and cold spots from 2020 to 2022, away from Bangkok region and dispersed across the central region, could be likely dodging anti-drug operations most concentrated near Thailand’s capital. Will need to incorporate policing activity data to ascertain this</p></li>
</ul>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> yr){</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>  HCSA <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span></span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>      possession_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>nb,</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>wts,</span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(HCSA)</span></span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb354-16"><a href="#cb354-16" aria-hidden="true" tabindex="-1"></a>  map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb354-17"><a href="#cb354-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span></span>
<span id="cb354-18"><a href="#cb354-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb354-19"><a href="#cb354-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb354-20"><a href="#cb354-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of no_cases for"</span>, year),</span>
<span id="cb354-21"><a href="#cb354-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb354-22"><a href="#cb354-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-23"><a href="#cb354-23" aria-hidden="true" tabindex="-1"></a>  map4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb354-24"><a href="#cb354-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb354-25"><a href="#cb354-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb354-26"><a href="#cb354-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span></span>
<span id="cb354-27"><a href="#cb354-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb354-28"><a href="#cb354-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of Gi* for"</span>, year),</span>
<span id="cb354-29"><a href="#cb354-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb354-30"><a href="#cb354-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-31"><a href="#cb354-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb354-32"><a href="#cb354-32" aria-hidden="true" tabindex="-1"></a>  HCSA_sig <span class="ot">&lt;-</span> HCSA  <span class="sc">%&gt;%</span></span>
<span id="cb354-33"><a href="#cb354-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb354-34"><a href="#cb354-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-35"><a href="#cb354-35" aria-hidden="true" tabindex="-1"></a>  map5 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb354-36"><a href="#cb354-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb354-37"><a href="#cb354-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb354-38"><a href="#cb354-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-39"><a href="#cb354-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(HCSA_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb354-40"><a href="#cb354-40" aria-hidden="true" tabindex="-1"></a>    map5 <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb354-41"><a href="#cb354-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(HCSA_sig) <span class="sc">+</span></span>
<span id="cb354-42"><a href="#cb354-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"cluster"</span>) <span class="sc">+</span></span>
<span id="cb354-43"><a href="#cb354-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb354-44"><a href="#cb354-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Map for"</span>, year), </span>
<span id="cb354-45"><a href="#cb354-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb354-46"><a href="#cb354-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb354-47"><a href="#cb354-47" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"No significant clusters found for"</span>, year)) }</span>
<span id="cb354-48"><a href="#cb354-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-49"><a href="#cb354-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map3, map4, map5, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb354-50"><a href="#cb354-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb354-51"><a href="#cb354-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-114-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-114-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-114-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-114-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-114-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Minor clustering trends near the capital, but most clusters disperse out further north and south ends away from Bangkok</li>
</ul>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> yr){</span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a>  HCSA <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span></span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb355-7"><a href="#cb355-7" aria-hidden="true" tabindex="-1"></a>      possession_with_intent_to_distribute_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb355-8"><a href="#cb355-8" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>nb,</span>
<span id="cb355-9"><a href="#cb355-9" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>wts,</span>
<span id="cb355-10"><a href="#cb355-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb355-11"><a href="#cb355-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb355-12"><a href="#cb355-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-13"><a href="#cb355-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(HCSA)</span></span>
<span id="cb355-14"><a href="#cb355-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-15"><a href="#cb355-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb355-16"><a href="#cb355-16" aria-hidden="true" tabindex="-1"></a>  map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb355-17"><a href="#cb355-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span></span>
<span id="cb355-18"><a href="#cb355-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb355-19"><a href="#cb355-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb355-20"><a href="#cb355-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of no_cases for"</span>, year),</span>
<span id="cb355-21"><a href="#cb355-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb355-22"><a href="#cb355-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-23"><a href="#cb355-23" aria-hidden="true" tabindex="-1"></a>  map4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb355-24"><a href="#cb355-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb355-25"><a href="#cb355-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb355-26"><a href="#cb355-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span></span>
<span id="cb355-27"><a href="#cb355-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb355-28"><a href="#cb355-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of Gi* for"</span>, year),</span>
<span id="cb355-29"><a href="#cb355-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb355-30"><a href="#cb355-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-31"><a href="#cb355-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb355-32"><a href="#cb355-32" aria-hidden="true" tabindex="-1"></a>  HCSA_sig <span class="ot">&lt;-</span> HCSA  <span class="sc">%&gt;%</span></span>
<span id="cb355-33"><a href="#cb355-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb355-34"><a href="#cb355-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-35"><a href="#cb355-35" aria-hidden="true" tabindex="-1"></a>  map5 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb355-36"><a href="#cb355-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb355-37"><a href="#cb355-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb355-38"><a href="#cb355-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-39"><a href="#cb355-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(HCSA_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb355-40"><a href="#cb355-40" aria-hidden="true" tabindex="-1"></a>    map5 <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb355-41"><a href="#cb355-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(HCSA_sig) <span class="sc">+</span></span>
<span id="cb355-42"><a href="#cb355-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"cluster"</span>) <span class="sc">+</span></span>
<span id="cb355-43"><a href="#cb355-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb355-44"><a href="#cb355-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Map for"</span>, year), </span>
<span id="cb355-45"><a href="#cb355-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb355-46"><a href="#cb355-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb355-47"><a href="#cb355-47" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"No significant clusters found for"</span>, year)) }</span>
<span id="cb355-48"><a href="#cb355-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-49"><a href="#cb355-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map3, map4, map5, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb355-50"><a href="#cb355-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb355-51"><a href="#cb355-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-115-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-115-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-115-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-115-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-115-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Similar significant hotspots pattern as previously mentioned mostly in the capital and neighbouring regions; significant coldspots down south</li>
</ul>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> yr){</span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>  HCSA <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span></span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a>      trafficking_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>nb,</span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>wts,</span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb356-12"><a href="#cb356-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-13"><a href="#cb356-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(HCSA)</span></span>
<span id="cb356-14"><a href="#cb356-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-15"><a href="#cb356-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb356-16"><a href="#cb356-16" aria-hidden="true" tabindex="-1"></a>  map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb356-17"><a href="#cb356-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span></span>
<span id="cb356-18"><a href="#cb356-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb356-19"><a href="#cb356-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb356-20"><a href="#cb356-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of no_cases for"</span>, year),</span>
<span id="cb356-21"><a href="#cb356-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb356-22"><a href="#cb356-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-23"><a href="#cb356-23" aria-hidden="true" tabindex="-1"></a>  map4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb356-24"><a href="#cb356-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb356-25"><a href="#cb356-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb356-26"><a href="#cb356-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span></span>
<span id="cb356-27"><a href="#cb356-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb356-28"><a href="#cb356-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of Gi* for"</span>, year),</span>
<span id="cb356-29"><a href="#cb356-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb356-30"><a href="#cb356-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-31"><a href="#cb356-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb356-32"><a href="#cb356-32" aria-hidden="true" tabindex="-1"></a>  HCSA_sig <span class="ot">&lt;-</span> HCSA  <span class="sc">%&gt;%</span></span>
<span id="cb356-33"><a href="#cb356-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb356-34"><a href="#cb356-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-35"><a href="#cb356-35" aria-hidden="true" tabindex="-1"></a>  map5 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb356-36"><a href="#cb356-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb356-37"><a href="#cb356-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb356-38"><a href="#cb356-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-39"><a href="#cb356-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(HCSA_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb356-40"><a href="#cb356-40" aria-hidden="true" tabindex="-1"></a>    map5 <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb356-41"><a href="#cb356-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(HCSA_sig) <span class="sc">+</span></span>
<span id="cb356-42"><a href="#cb356-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"cluster"</span>) <span class="sc">+</span></span>
<span id="cb356-43"><a href="#cb356-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb356-44"><a href="#cb356-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Map for"</span>, year), </span>
<span id="cb356-45"><a href="#cb356-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb356-46"><a href="#cb356-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb356-47"><a href="#cb356-47" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"No significant clusters found for"</span>, year)) }</span>
<span id="cb356-48"><a href="#cb356-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-49"><a href="#cb356-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map3, map4, map5, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb356-50"><a href="#cb356-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb356-51"><a href="#cb356-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-116-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-116-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-116-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-116-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-116-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Significant production cold spots in the northen and southern regions; Significant production hot spots being dispersed within the central region</p>
</div>
<div id="tabset-10-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> yr){</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a>  HCSA <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a>      production_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>nb,</span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>wts,</span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb357-11"><a href="#cb357-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb357-12"><a href="#cb357-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-13"><a href="#cb357-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(HCSA)</span></span>
<span id="cb357-14"><a href="#cb357-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-15"><a href="#cb357-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb357-16"><a href="#cb357-16" aria-hidden="true" tabindex="-1"></a>  map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb357-17"><a href="#cb357-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span></span>
<span id="cb357-18"><a href="#cb357-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb357-19"><a href="#cb357-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb357-20"><a href="#cb357-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of no_cases for"</span>, year),</span>
<span id="cb357-21"><a href="#cb357-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb357-22"><a href="#cb357-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-23"><a href="#cb357-23" aria-hidden="true" tabindex="-1"></a>  map4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb357-24"><a href="#cb357-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb357-25"><a href="#cb357-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb357-26"><a href="#cb357-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span></span>
<span id="cb357-27"><a href="#cb357-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb357-28"><a href="#cb357-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of Gi* for"</span>, year),</span>
<span id="cb357-29"><a href="#cb357-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb357-30"><a href="#cb357-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-31"><a href="#cb357-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb357-32"><a href="#cb357-32" aria-hidden="true" tabindex="-1"></a>  HCSA_sig <span class="ot">&lt;-</span> HCSA  <span class="sc">%&gt;%</span></span>
<span id="cb357-33"><a href="#cb357-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb357-34"><a href="#cb357-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-35"><a href="#cb357-35" aria-hidden="true" tabindex="-1"></a>  map5 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb357-36"><a href="#cb357-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb357-37"><a href="#cb357-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb357-38"><a href="#cb357-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-39"><a href="#cb357-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(HCSA_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb357-40"><a href="#cb357-40" aria-hidden="true" tabindex="-1"></a>    map5 <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb357-41"><a href="#cb357-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(HCSA_sig) <span class="sc">+</span></span>
<span id="cb357-42"><a href="#cb357-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"cluster"</span>) <span class="sc">+</span></span>
<span id="cb357-43"><a href="#cb357-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb357-44"><a href="#cb357-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Map for"</span>, year), </span>
<span id="cb357-45"><a href="#cb357-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb357-46"><a href="#cb357-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb357-47"><a href="#cb357-47" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"No significant clusters found for"</span>, year)) }</span>
<span id="cb357-48"><a href="#cb357-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-49"><a href="#cb357-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map3, map4, map5, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb357-50"><a href="#cb357-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb357-51"><a href="#cb357-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-117-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-117-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-117-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-117-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-117-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Significant production hot spots in the northen and southern regions; Significant product cold spots being dispersed within the central region, slowing diminishing over time.</p>
</div>
<div id="tabset-10-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> yr){</span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>  HCSA <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span></span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a>      import_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>nb,</span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>wts,</span>
<span id="cb358-10"><a href="#cb358-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb358-11"><a href="#cb358-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb358-12"><a href="#cb358-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-13"><a href="#cb358-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(HCSA)</span></span>
<span id="cb358-14"><a href="#cb358-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-15"><a href="#cb358-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb358-16"><a href="#cb358-16" aria-hidden="true" tabindex="-1"></a>  map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb358-17"><a href="#cb358-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span></span>
<span id="cb358-18"><a href="#cb358-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb358-19"><a href="#cb358-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb358-20"><a href="#cb358-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of no_cases for"</span>, year),</span>
<span id="cb358-21"><a href="#cb358-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb358-22"><a href="#cb358-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-23"><a href="#cb358-23" aria-hidden="true" tabindex="-1"></a>  map4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb358-24"><a href="#cb358-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb358-25"><a href="#cb358-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb358-26"><a href="#cb358-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span></span>
<span id="cb358-27"><a href="#cb358-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb358-28"><a href="#cb358-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of Gi* for"</span>, year),</span>
<span id="cb358-29"><a href="#cb358-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb358-30"><a href="#cb358-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-31"><a href="#cb358-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb358-32"><a href="#cb358-32" aria-hidden="true" tabindex="-1"></a>  HCSA_sig <span class="ot">&lt;-</span> HCSA  <span class="sc">%&gt;%</span></span>
<span id="cb358-33"><a href="#cb358-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb358-34"><a href="#cb358-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-35"><a href="#cb358-35" aria-hidden="true" tabindex="-1"></a>  map5 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb358-36"><a href="#cb358-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb358-37"><a href="#cb358-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb358-38"><a href="#cb358-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-39"><a href="#cb358-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(HCSA_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb358-40"><a href="#cb358-40" aria-hidden="true" tabindex="-1"></a>    map5 <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb358-41"><a href="#cb358-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(HCSA_sig) <span class="sc">+</span></span>
<span id="cb358-42"><a href="#cb358-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"cluster"</span>) <span class="sc">+</span></span>
<span id="cb358-43"><a href="#cb358-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb358-44"><a href="#cb358-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Map for"</span>, year), </span>
<span id="cb358-45"><a href="#cb358-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb358-46"><a href="#cb358-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb358-47"><a href="#cb358-47" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"No significant clusters found for"</span>, year)) }</span>
<span id="cb358-48"><a href="#cb358-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-49"><a href="#cb358-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map3, map4, map5, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb358-50"><a href="#cb358-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb358-51"><a href="#cb358-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-118-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-118-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-118-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-118-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-118-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Both significant hot and cold spots clustering down south end of Thailand’s border mostly; could be a sign of cross border drug operations.</p>
</div>
<div id="tabset-10-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> yr){</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(year, <span class="st">"compute local Gi* statistics"</span>))</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>  HCSA <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>      export_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>nb,</span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>wts,</span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>  map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span></span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of no_cases for"</span>, year),</span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb359-20"><a href="#cb359-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-21"><a href="#cb359-21" aria-hidden="true" tabindex="-1"></a>  map4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb359-22"><a href="#cb359-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb359-23"><a href="#cb359-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb359-24"><a href="#cb359-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span></span>
<span id="cb359-25"><a href="#cb359-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb359-26"><a href="#cb359-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of Gi* for"</span>, year),</span>
<span id="cb359-27"><a href="#cb359-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb359-28"><a href="#cb359-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-29"><a href="#cb359-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-30"><a href="#cb359-30" aria-hidden="true" tabindex="-1"></a>  map5 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb359-31"><a href="#cb359-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb359-32"><a href="#cb359-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb359-33"><a href="#cb359-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-34"><a href="#cb359-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(HCSA_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb359-35"><a href="#cb359-35" aria-hidden="true" tabindex="-1"></a>    map5 <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb359-36"><a href="#cb359-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(HCSA_sig) <span class="sc">+</span></span>
<span id="cb359-37"><a href="#cb359-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"cluster"</span>) <span class="sc">+</span></span>
<span id="cb359-38"><a href="#cb359-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb359-39"><a href="#cb359-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Map for"</span>, year), </span>
<span id="cb359-40"><a href="#cb359-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb359-41"><a href="#cb359-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb359-42"><a href="#cb359-42" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"No significant clusters found for"</span>, year)) }</span>
<span id="cb359-43"><a href="#cb359-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-44"><a href="#cb359-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map3, map4, map5, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb359-45"><a href="#cb359-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-46"><a href="#cb359-46" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017 compute local Gi* statistics"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2018 compute local Gi* statistics"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-119-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019 compute local Gi* statistics"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-119-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 compute local Gi* statistics"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-119-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021 compute local Gi* statistics"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-119-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022 compute local Gi* statistics"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-119-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No significant hot spots or clustering; sparse and dispersed cold spots across Thailand.</p>
</div>
<div id="tabset-10-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-8-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">69</span>)</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> yr){</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>    cases <span class="ot">=</span> conspiracy_cases <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fiscal_year<span class="sc">==</span>year) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="dv">2</span>)</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># checks if the year's vector has no_case = 0</span></span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(cases)<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Skipping year"</span>, year, <span class="st">"due to empty data (0 cases)"</span>))</span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>  <span class="co"># continue to next iteration</span></span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a>  HCSA <span class="ot">&lt;-</span> wm_idw <span class="sc">%&gt;%</span></span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true" tabindex="-1"></a>      cases,</span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>nb,</span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true" tabindex="-1"></a>      wm_idw<span class="sc">$</span>wts,</span>
<span id="cb366-18"><a href="#cb366-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">99</span>),<span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb366-19"><a href="#cb366-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(local_Gi)</span>
<span id="cb366-20"><a href="#cb366-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-21"><a href="#cb366-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(HCSA)</span></span>
<span id="cb366-22"><a href="#cb366-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-23"><a href="#cb366-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb366-24"><a href="#cb366-24" aria-hidden="true" tabindex="-1"></a>  map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb366-25"><a href="#cb366-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>) <span class="sc">+</span></span>
<span id="cb366-26"><a href="#cb366-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb366-27"><a href="#cb366-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb366-28"><a href="#cb366-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Gi* of no_cases for"</span>, year),</span>
<span id="cb366-29"><a href="#cb366-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb366-30"><a href="#cb366-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-31"><a href="#cb366-31" aria-hidden="true" tabindex="-1"></a>  map4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb366-32"><a href="#cb366-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_fill</span>(<span class="st">"p_value"</span>,</span>
<span id="cb366-33"><a href="#cb366-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb366-34"><a href="#cb366-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.05"</span>, <span class="st">"Not sig"</span>)) <span class="sc">+</span></span>
<span id="cb366-35"><a href="#cb366-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb366-36"><a href="#cb366-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"p-value of Gi* for"</span>, year),</span>
<span id="cb366-37"><a href="#cb366-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb366-38"><a href="#cb366-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-39"><a href="#cb366-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb366-40"><a href="#cb366-40" aria-hidden="true" tabindex="-1"></a>  HCSA_sig <span class="ot">&lt;-</span> HCSA  <span class="sc">%&gt;%</span></span>
<span id="cb366-41"><a href="#cb366-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(p_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb366-42"><a href="#cb366-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb366-43"><a href="#cb366-43" aria-hidden="true" tabindex="-1"></a>  map5 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(HCSA) <span class="sc">+</span></span>
<span id="cb366-44"><a href="#cb366-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb366-45"><a href="#cb366-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb366-46"><a href="#cb366-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-47"><a href="#cb366-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(HCSA_sig) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb366-48"><a href="#cb366-48" aria-hidden="true" tabindex="-1"></a>    map5 <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb366-49"><a href="#cb366-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(HCSA_sig) <span class="sc">+</span></span>
<span id="cb366-50"><a href="#cb366-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_fill</span>(<span class="st">"cluster"</span>) <span class="sc">+</span></span>
<span id="cb366-51"><a href="#cb366-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb366-52"><a href="#cb366-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"LISA Map for"</span>, year), </span>
<span id="cb366-53"><a href="#cb366-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title.size =</span> <span class="fl">0.666</span>)</span>
<span id="cb366-54"><a href="#cb366-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb366-55"><a href="#cb366-55" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"No significant clusters found for"</span>, year)) }</span>
<span id="cb366-56"><a href="#cb366-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-57"><a href="#cb366-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tmap_arrange</span>(map3, map4, map5, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb366-58"><a href="#cb366-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb366-59"><a href="#cb366-59" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-120-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-120-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_2_files/figure-html/unnamed-chunk-120-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Significant hotspots clustering near the capital became coldspots and dispersed over time.</p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>